<meta charset="utf-8">
<table id="scores">
  <!-- <tr>
  <td>Row1 cell1</td>
  <td>Row1 cell2</td>
</tr>
<tr>
  <td>Row2 cell1</td>
  <td>Row2 cell2</td>
</tr>
<tr>
  <td>Row3 cell1</td>
  <td>Row3 cell2</td>
</tr> -->
</table>
<div id="settings">
  <button type="button" id="saveData" name="button">Highscores und Pixel rates für offline Modus speichern</button>
  <input type="checkbox" onchange="localStorage.setItem('saveAutomaticly', checked);" id="saveAutomaticly">
  Staubsauger Größe<input value="50" min="1" max="222" oninput="maxLochHeight.min = JSON.parse(value)*1.5; maxLochWidth.min = JSON.parse(value)*1.5; minLochHeight.min = JSON.parse(value)*1.5; minLochWidth.min = JSON.parse(value)*1.5; minStaubSize.max = JSON.parse(value) - 1; maxStaubSize.max = JSON.parse(value); sphere1.style.width = value; sphere1.style.height = value;" id="staubsaugerSize" type="range">
  <br>
  restart round when hitting wall<input checked="true" type="checkbox" id="brokenCheck">
  <br>
  bounce von Wänden ab<input type="checkbox" id="bounceWalls">
  <br>
  <p id="joyStickPlayP">play with joy-stick<input id="joyStickPlay" type="checkbox"></p>
  <br>
  <font size="5">Staub</font><font onclick="var opposite = {visibility: {'none': 'inline', 'inline': 'none'}, innerHTML: {'⌃': '⌄', '⌄': '⌃'}}; staubDiv.style.display = opposite.visibility[staubDiv.style.display]; innerHTML = opposite.innerHTML[innerHTML];" size="6">⌄</font>
  <div id="staubDiv">
    <br>
    min. <input value="3" id="minStaubSize" oninput="if (JSON.parse(maxStaubSize.value) < JSON.parse(value)) {maxStaubSize.value = JSON.parse(value) + 1}" value="3" min="1" type="range">
    <br>
    max. <input value="24" id="maxStaubSize" oninput="minStaubSize.max = JSON.parse(value) - 1" min="1" value="22" type="range">
    <br>
    <input id="anzahlStaub" value="27" type="text">Staubkörner sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) {spielzeugDiv.style.display = 'inline'; spielzeugDiv.style.display = 'inline';} else {anzahlSpielzeug.value = 0; spielzeugDiv.style.display = 'none'; spielzeugDiv.style.display = 'none'}" type="checkbox"><font size="5">Spielzeug</font></p>
  <div id="spielzeugDiv">
    <input checked="true" id="stoppeBeiSpielzeug" type="checkbox">stoppe kurz(zum Entfernen)
    <br>
    <input id="langsamerBeiSpielzeug" onchange="if (checked) verlangsamungSpielzeugP.style.display = 'inline'; else verlangsamungSpielzeugP.style.display = 'none';" type="checkbox">werde langsamer
    <p id="verlangsamungSpielzeugP">
      time<input id="zeitLangsamer"value="endless" onchange="if (isNaN(value)) value = 'endless';" type="text">
      <br>
      <input checked="true" onchange="if (checked) clearWhenSlow.checked = false;" id="restartWhenSlow" type="checkbox">restart when speed gets too low
      <br>
      <input onchange="if (checked) restartWhenSlow.checked = false;" id="clearWhenSlow" type="checkbox" name="" value="">stay still when speed gets too low and continue with normal speed afterfords
      <br>
    </p>
    <br>
    <input type="checkbox" id="spielzeugWenigPlatz" checked="true">Spielzeug kann auch aufgesammelt werden,wenn im Staubsauger eigentlich nicht mer genug Platz ist
    <br>
    <input id="spielzeugPlatz" type="checkbox">Spielzeugt bleibt nicht im Sauger und nimmt somit auch keinen Platz ein
    <br>
    min. <input value="3" id="minSpielzeugSize" oninput="if (JSON.parse(maxSpielzeugSize.value) < JSON.parse(value)) {maxSpielzeugSize.value = JSON.parse(value) + 1}" value="3" min="1" type="range">
    <br>
    max. <input value="24" id="maxSpielzeugSize" oninput="minSpielzeugSize.max = JSON.parse(value) - 1" min="1" value="22" type="range">
    <br>
    <input id="anzahlSpielzeug" value="22" type="text">Spielzeuge sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) {SchmuckDiv.style.display = 'inline'; SchmuckDiv.style.display = 'inline';} else {anzahlSchmuck.value = 0; SchmuckDiv.style.display = 'none'; SchmuckDiv.style.display = 'none'}" type="checkbox"><font size="5">Schmuck</font></p>
  <div id="SchmuckDiv">
    min. <input value="3" id="minSchmuckSize" oninput="if (JSON.parse(maxSchmuckSize.value) < JSON.parse(value)) {maxSchmuckSize.value = JSON.parse(value) + 1}" value="3" min="1" type="range">
    <br>
    max. <input value="24" id="maxSchmuckSize" oninput="minSchmuckSize.max = JSON.parse(value) - 1" min="1" value="22" type="range">
    <br>
    <input id="anzahlSchmuck" value="3" type="text">Schmuckstücke sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) TeppichDiv.style.display = 'inline'; else {anzahlTeppich.value = 0; TeppichDiv.style.display = 'none';}" type="checkbox"><font size="5">Teppich</font></p>
  <div id="TeppichDiv">
    min. width <input value="33" min="11" id="minTeppichWidth" oninput="if (JSON.parse(maxTeppichWidth.value) < JSON.parse(value)) {maxTeppichWidth.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. width <input value="411" min="11" oninput="minTeppichWidth.max = JSON.parse(value) - 1" id="maxTeppichWidth" type="range">
    <br>
    min. height <input value="33" min="11" id="minTeppichHeight" oninput="if (JSON.parse(maxTeppichHeight.value) < JSON.parse(value)) {maxTeppichHeight.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. height <input value="411" min="11" oninput="minTeppichHeight.max = JSON.parse(value) - 1" id="maxTeppichHeight" type="range">
    <br>
    Verlangsamung (rechts ist weniger)<input value="11" id="verlangsamungTeppich" min="11" max="19" type="range">
    <br>
    <input id="anzahlTeppich" value="1" type="text">Teppiche sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) moebelDiv.style.display = 'inline'; else {moebelDiv.style.display = 'none'; anzahlMoebel.value = 0;}" type="checkbox"><font size="5">Möbel</font></p>
  <div id="moebelDiv">
    min. width <input value="23" id="minMoebelWidth" oninput="if (JSON.parse(maxMoebelWidth.value) < JSON.parse(value)) {maxMoebelWidth.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. width <input value="155" oninput="minMoebelWidth.max = JSON.parse(value) - 1" id="maxMoebelWidth" type="range">
    <br>
    min. height <input value="23" id="minMoebelHeight" oninput="if (JSON.parse(maxMoebelHeight.value) < JSON.parse(value)) {maxMoebelHeight.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. height <input value="155" oninput="minMoebelHeight.max = JSON.parse(value) - 1" id="maxMoebelHeight" type="range">
    <input id="anzahlMoebel" value="4" type="text">Möbel sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) LochDiv.style.display = 'inline'; else {LochDiv.style.display = 'none'; anzahlLoecher.value = 0;}" type="checkbox"><font size="5">Loch</font></p>
  <div id="LochDiv">
    min. width <input value="51" id="minLochWidth" oninput="if (JSON.parse(maxLochWidth.value) < JSON.parse(value)) {maxLochWidth.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. width <input value="133" oninput="minLochWidth.max = JSON.parse(value) - 1" id="maxLochWidth" type="range">
    <br>
    min. height <input value="51" id="minLochHeight" oninput="if (JSON.parse(maxLochHeight.value) < JSON.parse(value)) {maxLochHeight.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. height <input oninput="minLochHeight.max = JSON.parse(value) - 1" id="maxLochHeight" type="range">
    <br>
    <input id="anzahlLoecher" value="2" type="text">Löcher sollen es insgesamt sein!
  </div>
  <p><input checked="true" onchange="if (checked) ladestationDiv.style.display = 'inline'; else {anzahlLadestationen.value = 0; ladestationDiv.style.display = 'none';}" type="checkbox"><font size="5">Ladestation</font></p>
  <div id="ladestationDiv">
    <input id="pixelBisLadenCheck" onchange="if (checked) StaubAlsLadeBasisCheck.checked = false;" type="checkbox"> nach <input type="text" id="pixelBisLadenT" placeholder="anzahl" value="3333"> Pixeln Akku leer
    <br>
    <input onchange="if (checked) pixelBisLadenCheck.checked = false;" id="StaubAlsLadeBasisCheck" checked="true" type="checkbox"> nach <input id="staubAlsLadeBasisT" type="text" placeholder="anzahl" value="5.5"> mal so vielen Pixeln, wie aller Staub zusammen Akku leer
    <br>
    min. width <input value="33" id="minLaderWidth" oninput="if (JSON.parse(maxLaderWidth.value) < JSON.parse(value)) {maxLaderWidth.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. width <input value="100" oninput="minLaderWidth.max = JSON.parse(value) - 1" id="maxLaderWidth" type="range">
    <br>
    min. height <input value="33" id="minLaderHeight" oninput="if (JSON.parse(maxLaderHeight.value) < JSON.parse(value)) {maxLaderHeight.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. height <input value="100" oninput="minLaderHeight.max = JSON.parse(value) - 1" id="maxLaderHeight" type="range">
    <br>
    <input id="anzahlLadestationen" value="1" type="text">Ladestationen sollen es insgesamt sein!
    <br>
    <input id="showWayLadestation" type="checkbox">Weg dahin kennzeichnen
  </div>
  <p><input checked="true" onchange="if (checked) {entleererDiv.style.display = 'inline';} else {anzahlEntleerer.value = 0; entleererDiv.style.display = 'none';}" type="checkbox"><font size="5">Entleerer (Staub behälter entleeren, um neuen aufsammeln zu können)</font></p>
  <div id="entleererDiv">
    <input id="pixelBisLeerenCheck" onchange="if (checked) StaubAlsLeerBasisCheck.checked = false;" type="checkbox"> nach <input  id="pixelBisLeerenT" type="text" placeholder="anzahl" value="500"> Pixeln keinen Staub mehr aufnehmen
    <br>
    <input onchange="if (checked) pixelBisLeerenCheck.checked = false;" id="StaubAlsLeerBasisCheck" checked="true" type="checkbox"> nach <input id="StaubAlsLeerBasisT" type="text" placeholder="anzahl" value="2">geteilt durch pixel Anzahl des gesamten Staubes keinen Staub mehr aufnehmen
    <br>
    min. width <input value="33" id="minLeererWidth" oninput="if (JSON.parse(maxLeererWidth.value) < JSON.parse(value)) {maxLeererWidth.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. width <input value="100" oninput="minLeererWidth.max = JSON.parse(value) - 1" id="maxLeererWidth" type="range">
    <br>
    min. height <input value="33" id="minLeererHeight" oninput="if (JSON.parse(maxLeererHeight.value) < JSON.parse(value)) {maxLeererHeight.value = JSON.parse(value) + 1}" type="range">
    <br>
    max. height <input value="100" oninput="minLeererHeight.max = JSON.parse(value) - 1" id="maxLeererHeight" type="range">
    <br>
    <input id="anzahlEntleerer" value="1" type="text">Entleerer sollen es insgesamt sein!
    <br>
    <input id="showWayEntleerer" type="checkbox">Weg dahin kennzeichnen
  </div>
  <button type="button" onclick="createNewPixelRate();" id="createButton" name="button">create</button>
</div>
<canvas onclick="canvasClicked();" id="textur" width="1900" height="700"></canvas>
<br>
Sensibilität des Joy-Sticks (je weiter rechts, desto mehr Weg muss zurrück gelegt werden)<input id="sensibility" onchange="window.scroll(9, 9);" type="range" min="1" max="27">
<br>
<input id="cleanerAudio" onchange="playCleanerSound();" type="checkbox"checked="true">Staubsauger Audio
<br>
<input id="clenerFiepAudio" onchange="playCleanerSound();" type="checkbox"checked="true">mit leichtem Piepen
<div id="wegWeiser">
  <br>
  <input onchange="showWayLadestation.checked = checked" type="checkbox">Weg zu Ladestation kennzeichnen
  <input id="showWayLaderWhenLow" type="checkbox">Nur anzeigen, wenn Füllstad zu niedrig
  <br>
  <input onchange="showWayEntleerer.checked = checked;" type="checkbox">Weg zu Entleerer kennzeichnen
  <input id="showWayEntleererWhenLow" type="checkbox">Nur anzeigen, wenn Füllstad zu hoch
</div>
<h1 id="nameEingeloggt" onclick='name = prompt ("Mit welchem Namen wollen sie sich eingloggen?"); nameEingeloggt.innerHTML = "als " + name + " eingeloggt"; getDatabase();'></h1>
<div id="app">
  <div id="authors" style="font-size: 25px" v-for="genre in genres">
    <h2 onclick="useSameRate = false; if (innerHTML == 'create own pixel rate') settings.style.display = 'inline'; else if (confirm('Wollen sie genau diese Größe als pixelRate verwenden?')) {settings.style.display = 'inline'; useSameRate = innerHTML} settingsAnpassen();">{{ genre }}</h2>
<ul id="db">
  <li id="titles" style="font-size: 23px" onclick="levelSelected(innerText);" v-for="abc in db[genre]"> {{ abc }} </li>
</ul>
</div>
</div>
<script src="https://adi.nicolaiweitkemper.de/Database2/js.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<div id="ball">
  <style>
    .shape {
      position: absolute;
      width: 50px;
      height: 50px;
      -webkit-radius: 50px;
      margin: 0;
      width padding: 0;
    }

    #sphere1 {
      border-radius: 50px;
      background-color: grey;
    }
    .bars {
      position: absolute;
      width: 11px;
      height: 40px;
      -webkit-radius: 50px;
      margin: 0;
      width padding: 0;
    }
    #energyBar {
      border-radius: 50px;
      background-color: green;
    }
    #trashBar {
      border-radius: 50px;
      background-color: #A4A4A4;
    }
  </style>
</div>
<div id="content">
  <div class="shape" id="sphere1"></div>
  <div class="bars" id="energyBar"></div>
  <div class="bars" id="trashBar"></div>
</div>
<script>
  var useSameRate = false;
  var realHeight = window.innerHeight;
  textur.style.display = "none";
  staubDiv.style.display = "none";
  verlangsamungSpielzeugP.style.display = "none";
  settings.style.display = "none";
  wegWeiser.style.display = "none";

  maxTeppichHeight.value = 411;
  minTeppichWidth.value = 410;
  function settingsAnpassen() {
    var pWindow = {innerWidth: window.innerWidth, innerHeight: window.innerHeight};
    if (useSameRate != false) {pWindow.innerWidth = JSON.parse(useSameRate.toString().split(" x ")[0]); pWindow.innerHeight = JSON.parse(useSameRate.toString().split(" x ")[1]);}
    anzahlStaub.value = Math.round(pWindow.innerWidth/25);
    maxTeppichWidth.max = pWindow.innerWidth;
    maxTeppichHeight.max = pWindow.innerHeight;
    minTeppichWidth.max = pWindow.innerWidth - 1;
    minTeppichHeight.max = pWindow.innerHeight - 1;
    maxLochWidth.max = pWindow.innerWidth;
    maxLochHeight.max = pWindow.innerHeight;
    minLochWidth.max = pWindow.innerWidth - 1;
    minLochHeight.max = pWindow.innerHeight - 1;
  }
  // spielzeugDiv.style.display = "none";
  // sphere1.style.top = "175";
  // sphere1.style.left = "9";
  // energyBar.style.left = "20";
  // energyBar.style.top = "180";
  // trashBar.style.left = "37";
  // trashBar.style.top = "180";
  // setTimeout(function () {
  //   energyBar.style.height = 30;
  //   energyBar.style.top = "190";
  // }, 3333);
  var canvas = textur.getContext('2d');
  if (!localStorage.getItem("storedName")) var name = prompt("Bitte geben sie ihren (spitz) Namen ein, um ihre Highscores speichern zu können");
  else var name = localStorage.getItem("storedName");
localStorage.setItem("storedName", name);
  nameEingeloggt.innerHTML = "als " + name + " eingeloggt"
  getDatabase();
  console.log(window.innerWidth + " - " + window.innerHeight);
  var highscores = {normal: {}};
  function getDatabase(sync) {
    dbGet("cleanTheRoom", "highscores").then(result => {
      highscores = result;
      highscoresToList(highscores);
      //clickListCheck();
      if (sync) syncFinished = true;
      else if (localStorage.getItem("saveAutomaticly") != undefined) {
          saveAutomaticly.checked = localStorage.getItem("saveAutomaticly");
          if (saveAutomaticly.checked) localStorage.setItem("highscoresCleanTheRoom", JSON.stringify(highscores));
          saveAutomaticly.style.display = "inline";
        }
        else saveAutomaticly.style.display = "none";
        // pixelRate: selected.pixelRate, gegenstaende: selected.gegenstaende, gerät: selected.gerät, joyStick: (joyStickPlay.checked + "").replace("true", "joy-stick").replace("false", "no joy-stick"), data: mins + ":" + secs + ":" + "0" + tenths
        if (localStorage.getItem("newPixelRate") != undefined) {
          // newPixelRates.push({pixelRate: selected.pixelRate, gegenstaende: selected.gegenstaende, data: highscores.normal[selected.pixelRate][selected.gegenstaende]});
          for (var i = 0; i < JSON.parse(localStorage.getItem("newPixelRate")).length; i++) {
            if (!highscores[JSON.parse(localStorage.getItem("newPixelRate")[i].pixelRate)]) highscores[JSON.parse(localStorage.getItem("newPixelRate")[i].pixelRate)] = {};
            if (!highscores[JSON.parse(localStorage.getItem("newPixelRate")[i].pixelRate)][JSON.parse(localStorage.getItem("newPixelRate")[i].gegenstaende)]) highscores[JSON.parse(localStorage.getItem("newPixelRate")[i].pixelRate)][JSON.parse(localStorage.getItem("newPixelRate")[i].gegenstaende)] = {};
            highscores[JSON.parse(localStorage.getItem("newPixelRate")[i].pixelRate)][JSON.parse(localStorage.getItem("newPixelRate")[i].gegenstaende)] = JSON.parse(localStorage.getItem("newPixelRate")[i].data);
          }
          localStorage.setItem("newPixelRate", JSON.stringify([]));
        }
        if (!sync && localStorage.getItem("newHighscores") != undefined) {
          for (var i = 0; i < localStorage.getItem("newHighscores").length; i++) {
            if (!highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)]) highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)] = {};
             if (!highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)][JSON.parse(localStorage.getItem("newHighscores")[i].gegenstaende)]) highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)][JSON.parse(localStorage.getItem("newHighscores")[i].gegenstaende)] = {highscores: {}};
             if (!highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)][JSON.parse(localStorage.getItem("newHighscores")[i].gegenstaende)].highscores[JSON.parse(localStorage.getItem("newHighscores")[i].gerät)]) highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)][JSON.parse(localStorage.getItem("newHighscores")[i].gegenstaende)].highscores[JSON.parse(localStorage.getItem("newHighscores")[i].gerät)] = {};
             highscores[JSON.parse(localStorage.getItem("newHighscores")[i].pixelRate)][JSON.parse(localStorage.getItem("newHighscores")[i].gegenstaende)].highscores[JSON.parse(localStorage.getItem("newHighscores")[i].gerät)][JSON.parse(localStorage.getItem("newHighscores")[i].joyStick)] = JSON.parse(localStorage.getItem("newHighscores")[i].data);
             localStorage.setItem("newHighscores", JSON.stringify([]));
          }
        }
      console.log("sync finished!");
    }).catch(function(e) {
      app = new Vue({
        el: '#app',
        data: {
          db: {"create own pixel rate": {}},
          genres: ["create own pixel rate"],
          input: '',
        }
      })
      //clickListCheck();
      if (sync) syncFinished = true;
      else if (e == "TypeError: Failed to fetch") {
        alert("Der offline Modus ist aktiviert! Sie können neue zufällige Level erstellen (auch ohne dass sie gespeichert werden). Zudem können sie falls sie mit dieser Datei schon Mal die daten heruntergeladen haben die damaligen highscores angezeigen und neue, falls sie neue aufstellen, wenn sie mit dieser Datei später ins Internet gehen hochgeladen!");
        offline = true;
        if (localStorage.getItem("highscoresCleanTheRoom")) {
          highscores = JSON.parse(localStorage.getItem("highscoresCleanTheRoom"));
          highscoresToList(highscores);
        }
        else alert("Es wurde keine Aufzeichnung der Highscores oder pixel rates gefunden!");
      }
    });
  }
  function highscoresToList(result) {
    var format = JSON.parse(JSON.stringify(result.normal));
    format["create own pixel rate"] = {};
    for (var i = 0; i < Object.keys(format).length; i++) {
      format[Object.keys(format)[i]] = Object.keys(format[Object.keys(format)[i]]);
    }
    app = new Vue({
      el: '#app',
      data: {
        db: format,
        genres: Object.keys(format),
        input: '',
      }
    })
  }
  function saveData() {
    if (confirm("WARNUNG: Sie müssen die Website schon jetzt über die Datei geöffnet haben, mit der sie später offline spielen wollen!")) {
      saveAutomaticly.style.display = "inline";
      if (!localStorage.getItem("saveAutomaticly")) {
        saveAutomaticly.checked = confirm("Wollen sie, dass die Daten immer hochgeladen werden, wenn sie diese Datei öffnen?");
        localStorage.setItem("saveAutomaticly", saveAutomaticly.checked);
      }
      localStorage.setItem("highscoresCleanTheRoom", JSON.stringify(highscores));
    }
  }
  var offline = false;
  var joyStick;
  function createNewPixelRate() {
    getDatabase();
    setTimeout(function () {
    x1 = 0;
    y1 = 0;
    settings.style.display = "none";
    if (JSON.parse(anzahlLadestationen.value) > 0) energyBar.style.display = "inline";
    else energyBar.style.display = "none";
    if (JSON.parse(anzahlEntleerer.value)) trashBar.style.display = "inline";
    else trashBar.style.display = "none";
    if (useSameRate == false) selected.pixelRate = (window.innerWidth - 9) + " x " + (window.innerHeight - 9);
    else selected.pixelRate = useSameRate;
    textur.width = window.innerWidth - 9;
    textur.height = window.innerHeight - 9;
    console.log(window.innerWidth + " - " + textur.width);
    selected.gegenstaende = "loecher: " + anzahlLoecher.value + ", Moebel: " + anzahlMoebel.value + ", Teppich: " + anzahlTeppich.value + ", Ladestationen: " + anzahlLadestationen.value + ", Entleerer: " + anzahlEntleerer.value + ", Spielzeug: " + anzahlSpielzeug.value + ", schmuck: " + anzahlSchmuck.value + ", Staub: " + anzahlStaub.value;
    if (highscores.normal[selected.pixelRate] != undefined && Object.keys(highscores.normal[selected.pixelRate]).includes(selected.gegenstaende)) selected.gegenstaende += "|";
    if (!highscores.normal[selected.pixelRate]) highscores.normal[selected.pixelRate] = {};
    highscores.normal[selected.pixelRate][selected.gegenstaende] = {pixelRate: selected.pixelRate, settings: "Neustart wenn Wand berührt: " + brokenCheck.checked + ", bounce von Rändern: " + bounceWalls.checked + ", stoppe bei Spielzeug: " + stoppeBeiSpielzeug.checked + ", werde langsamer bei Spielzeug: " + langsamerBeiSpielzeug.checked + ", Spielzeug kann auch bei zu wenig Platz aufgesammelt werden: " + spielzeugWenigPlatz.checked + ", Spielzeug frisst keinen Platz im Speicher: " + spielzeugPlatz.checked, settingsConverted: {value: {}, checked: {}}, objects: {vertiefung: [], staub: [], moebel: [], teppich: [], ladestation: [], leererStation: [], spielzeug: [], schmuck: []}};
    var convertList = {value: ["staubsaugerSize", "verlangsamungTeppich", "zeitLangsamer" /*"pixelBisLadenT", "pixelBisLeerenT", "staubAlsLadeBasisT", "StaubAlsLeerBasisT"*/], checked: [/*"pixelBisLadenCheck", "StaubAlsLadeBasisCheck", "pixelBisLadenCheck", "StaubAlsLeerBasisCheck", "brokenCheck", "bounceWalls", */"bounceWalls", "stoppeBeiSpielzeug", "langsamerBeiSpielzeug", "spielzeugWenigPlatz", "spielzeugPlatz"]}
    for (var i = 0; i < Object.keys(convertList).length; i++) {
      for (var i1 = 0; i1 < convertList[Object.keys(convertList)[i]].length; i1++) {
        if (Object.keys(convertList)[i] == "value") highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(convertList)[i]][convertList[Object.keys(convertList)[i]][i1]] = document.getElementById(convertList[Object.keys(convertList)[i]][i1]).value;
        else highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(convertList)[i]][convertList[Object.keys(convertList)[i]][i1]] = document.getElementById(convertList[Object.keys(convertList)[i]][i1]).checked;
      }
    }
    for (var i = 0; i < JSON.parse(anzahlLoecher.value) /*2*/; i++) { // Vertiefung
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.vertiefung.push({x: Math.round(Math.random() *(window.innerWidth)), y: Math.round(Math.random() *(window.innerHeight)), width: Math.round(Math.random() *(JSON.parse(maxLochWidth.value) - JSON.parse(minLochWidth.value))) + JSON.parse(minLochWidth.value)/*51*/, height: Math.round(Math.random() *(/*133*/JSON.parse(maxLochHeight.value) - JSON.parse(minLochHeight.value))) + JSON.parse(minLochHeight.value)});
    }
    for (var i = 0; i < JSON.parse(anzahlMoebel.value)/*4*/; i++) { // Möbel
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.moebel.push({x: Math.round(Math.random() *(window.innerWidth)), y: Math.round(Math.random() *(window.innerHeight)), width: Math.round(Math.random() *(/*155*/JSON.parse(maxMoebelWidth.value) - JSON.parse(minMoebelWidth.value))) + /*23*/JSON.parse(minMoebelWidth.value), height: Math.round(Math.random() *(/*155*/JSON.parse(maxMoebelHeight.value) - JSON.parse(minMoebelHeight.value))) + /*23*/JSON.parse(minMoebelHeight.value)});
    }
    for (var i = 0; i < /*1*/JSON.parse(anzahlTeppich.value); i++) { // teppich
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.teppich.push({x: Math.round(Math.random() *(window.innerWidth)), y: Math.round(Math.random() *(window.innerHeight)), width: Math.round(Math.random() *(/*444*/JSON.parse(maxTeppichWidth.value) - JSON.parse(minTeppichWidth.value))) + JSON.parse(minTeppichWidth.value)/*33*/, height: Math.round(Math.random() *(/*444*/JSON.parse(maxTeppichHeight.value) - JSON.parse(minTeppichHeight.value))) + JSON.parse(minTeppichHeight.value)/*33*/});
    }
    for (var i = 0; i < /*1*/JSON.parse(anzahlLadestationen.value); i++) { // ladestation
      var side = Math.round(Math.random() *(3));
      if (side == 0) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.ladestation.push({x: Math.round(Math.random() *(window.innerWidth - cssToNumber(sphere1.style.width))), y: 0, width: Math.round(Math.random() *(/*50**/JSON.parse(minLaderWidth.value) - JSON.parse(minLaderWidth.value))) + JSON.parse(minLaderWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLaderHeight.value) - JSON.parse(minLaderHeight.value))) + JSON.parse(minLaderHeight.value)/*33*/});
      else if (side == 1) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.ladestation.push({x: Math.round(Math.random() *(window.innerWidth - cssToNumber(sphere1.style.width))), y: window.innerHeight - cssToNumber(sphere1.style.width), width: Math.round(Math.random() *(/*50**/JSON.parse(minLaderWidth.value) - JSON.parse(minLaderWidth.value))) + JSON.parse(minLaderWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLaderHeight.value) - JSON.parse(minLaderHeight.value))) + JSON.parse(minLaderHeight.value)/*33*/});
      else if (side == 2) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.ladestation.push({x: 0, y: Math.round(Math.random() *(window.innerHeight - cssToNumber(sphere1.style.width))), width: Math.round(Math.random() *(/*50**/JSON.parse(minLaderWidth.value) - JSON.parse(minLaderWidth.value))) + JSON.parse(minLaderWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLaderHeight.value) - JSON.parse(minLaderHeight.value))) + JSON.parse(minLaderHeight.value)/*33*/});
      else if (side == 3) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.ladestation.push({x: window.innerWidth - cssToNumber(sphere1.style.width), y: Math.round(Math.random() *(window.innerHeight - cssToNumber(sphere1.style.width))), width: Math.round(Math.random() *(/*50**/JSON.parse(minLaderWidth.value) - JSON.parse(minLaderWidth.value))) + JSON.parse(minLaderWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLaderHeight.value) - JSON.parse(minLaderHeight.value))) + JSON.parse(minLaderHeight.value)/*33*/});
    }
    for (var i = 0; i < /*1*/JSON.parse(anzahlEntleerer.value); i++) { // leererStation
      var side = Math.round(Math.random() *(3));
      if (side == 0) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.leererStation.push({x: Math.round(Math.random() *(window.innerWidth - cssToNumber(sphere1.style.width))), y: 0, width: Math.round(Math.random() *(/*50**/JSON.parse(minLeererWidth.value) - JSON.parse(minLeererWidth.value))) + JSON.parse(minLeererWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLeererHeight.value) - JSON.parse(minLeererHeight.value))) + JSON.parse(minLeererHeight.value)/*33*/});
      else if (side == 1) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.leererStation.push({x: Math.round(Math.random() *(window.innerWidth - cssToNumber(sphere1.style.width))), y: window.innerHeight - cssToNumber(sphere1.style.width), width: Math.round(Math.random() *(/*50**/JSON.parse(minLeererWidth.value) - JSON.parse(minLeererWidth.value))) + JSON.parse(minLeererWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLeererHeight.value) - JSON.parse(minLeererHeight.value))) + JSON.parse(minLeererHeight.value)/*33*/});
      else if (side == 2) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.leererStation.push({x: 0, y: Math.round(Math.random() *(window.innerHeight - cssToNumber(sphere1.style.width))), width: Math.round(Math.random() *(/*50**/JSON.parse(minLeererWidth.value) - JSON.parse(minLeererWidth.value))) + JSON.parse(minLeererWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLeererHeight.value) - JSON.parse(minLeererHeight.value))) + JSON.parse(minLeererHeight.value)/*33*/});
      else if (side == 3) highscores.normal[selected.pixelRate][selected.gegenstaende].objects.leererStation.push({x: window.innerWidth - cssToNumber(sphere1.style.width), y: Math.round(Math.random() *(window.innerHeight - cssToNumber(sphere1.style.width))), width: Math.round(Math.random() *(/*50**/JSON.parse(minLeererWidth.value) - JSON.parse(minLeererWidth.value))) + JSON.parse(minLeererWidth.value)/*50*/, height: Math.round(Math.random() *(/*50**/JSON.parse(minLeererHeight.value) - JSON.parse(minLeererHeight.value))) + JSON.parse(minLeererHeight.value)/*33*/});
    }
    for (var i = 0; i < /*7*/JSON.parse(anzahlSpielzeug.value); i++) { // hindernisseAufsaugen ("spielzeug")
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.spielzeug.push({x: Math.round(Math.random() *(window.innerWidth)), y: Math.round(Math.random() *(window.innerHeight)), radius: Math.round(Math.random() *(/*22*/JSON.parse(maxSpielzeugSize.value) - JSON.parse(minSpielzeugSize.value))) + JSON.parse(minSpielzeugSize.value)/*3*/, collected: false});
    }
    for (var i = 0; i < /*7*/JSON.parse(anzahlSchmuck.value); i++) { // hindernisseAufsaugen ("spielzeug")
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.schmuck.push({x: Math.round(Math.random() *(window.innerWidth)), y: Math.round(Math.random() *(window.innerHeight)), radius: Math.round(Math.random() *(/*22*/JSON.parse(maxSchmuckSize.value) - JSON.parse(minSchmuckSize.value))) + JSON.parse(minSchmuckSize.value)/*3*/, collected: false});
    }
    //setTimeout(function () {
    verfallsdaten = {ladung: 0, füllungLeft: 0};
    for (var i = 0; i < /*27*/JSON.parse(anzahlStaub.value); i++) { // Staub
      var radius = Math.round(Math.random() *(/*22*/JSON.parse(maxSpielzeugSize.value) - JSON.parse(minStaubSize.value))) + JSON.parse(minStaubSize.value)/*3*/;
      verfallsdaten.füllungLeft += radius*2;
      highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.push({x: Math.round(Math.random() *(window.innerWidth)) + radius, y: Math.round(Math.random() *(window.innerHeight)) + radius, radius: radius, collected: false});
      i2 = "defined";
      if (highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.length - 1].x > window.innerWidth - radius || highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.length - 1].y > window.innerHeight - radius) {
        i--;
        i2 = "skip";
        highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.pop();}
      try {
        for (var i1 = 0; i2 != "skip" && i1 != -1 && i1 < Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects).length; i1++) {
          for (var i2 = 0; i2 != -1 && i2 < highscores.normal[selected.pixelRate][selected.gegenstaende].objects[Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1]].length; i2++) {
            // canvas.fillStyle = "red";
            // canvas.fillRect(highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[i].x, highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[i].y, highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[i].radius*2, highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[i].radius*2);
            //console.log(Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1] != "staub" && Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1] != "spielzeug" && isCollide(JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].objects[Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1]][i2])), JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.length - 1]))));
            if (Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1] != "staub" && Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1] != "spielzeug" && isCollide(JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].objects[Object.keys(highscores.normal[selected.pixelRate][selected.gegenstaende].objects)[i1]][i2])), JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub[highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.length - 1])))) {
              highscores.normal[selected.pixelRate][selected.gegenstaende].objects.staub.pop();
              i--;
              verfallsdaten.füllungLeft -= radius*2;
              i2 = -2;
              i1 = -2;
            }
          }
        }
      } catch (e) {
        console.log("please debug :( " + e);
      }
    }
    if (StaubAlsLadeBasisCheck.checked) verfallsdaten.ladung = verfallsdaten.füllungLeft*JSON.parse(staubAlsLadeBasisT.value)//11;
    else verfallsdaten.ladung = JSON.parse(pixelBisLadenT.value);
    verfallsdaten.füllungLeft /= JSON.parse(StaubAlsLeerBasisT.value);//2;
    if (pixelBisLeerenCheck.checked) verfallsdaten.füllungLeft = JSON.parse(pixelBisLeerenT.value);
    highscores.normal[selected.pixelRate][selected.gegenstaende].maxVerfallsdaten = JSON.parse(JSON.stringify(verfallsdaten));
  //}, 1000);
    selected.objects = JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].objects));
    selected.maxVerfallsdaten = highscores.normal[selected.pixelRate][selected.gegenstaende].maxVerfallsdaten;
    resetLevel();
    if (!offline) dbSetWarteschlange.push({tag: "highscores", data: highscores});
    else/*TODO*/ {
      var newPixelRates = [];
      if (localStorage.getItem("newPixelRate")) newPixelRates = JSON.parse(localStorage.getItem("newPixelRate"));
      newPixelRates.push({pixelRate: selected.pixelRate, gegenstaende: selected.gegenstaende, data: highscores.normal[selected.pixelRate][selected.gegenstaende]});
      localStorage.setItem("newPixelRate", JSON.stringify(newPixelRates));
    }
    }, 1111);
  }
  var dbSetWarteschlange = [];
  setInterval(function () {
    if (dbSetWarteschlange.length > 0) {
      dbSet("cleanTheRoom", dbSetWarteschlange[0].tag, dbSetWarteschlange[0].data);
      dbSetWarteschlange.shift();
    }
  }, 2222);
  function levelSelected(name) {
    wegWeiser.style.display = "inline";
    for (var i = 0; i < Object.keys(highscores.normal).length; i++) {
      if (highscores.normal[Object.keys(highscores.normal)[i]][name] != undefined && Object.keys(highscores.normal)[i] == highscores.normal[Object.keys(highscores.normal)[i]][name].pixelRate) {
        console.log("level " + name + " with pixel rate " + Object.keys(highscores.normal)[i] + " selected!");
        selected = {gegenstaende: name, maxVerfallsdaten: highscores.normal[Object.keys(highscores.normal)[i]][name].maxVerfallsdaten, pixelRate: Object.keys(highscores.normal)[i], objects: highscores.normal[Object.keys(highscores.normal)[i]][name].objects, settings: highscores.normal[Object.keys(highscores.normal)[i]][name].settings, settingsConverted: highscores.normal[Object.keys(highscores.normal)[i]][name].settingsConverted};
        for (var i = 0; i < Object.keys(selected.settingsConverted).length; i++) {
          for (var i1 = 0; i1 < Object.keys(selected.settingsConverted[Object.keys(selected.settingsConverted)[i]]).length; i1++) {
            if (Object.keys(selected.settingsConverted)[i] == "value") document.getElementById(Object.keys(selected.settingsConverted[Object.keys(selected.settingsConverted)[i]])[i1]).value = highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(selected.settingsConverted)[i]][Object.keys(selected.settingsConverted[Object.keys(selected.settingsConverted)[i]])[i1]];
            else document.getElementById(Object.keys(selected.settingsConverted[Object.keys(selected.settingsConverted)[i]])[i1]).checked = highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(selected.settingsConverted)[i]][Object.keys(selected.settingsConverted[Object.keys(selected.settingsConverted)[i]])[i1]];
          }
        }
        /*
        for (var i = 0; i < Object.keys(convertList).length; i++) {
          for (var i1 = 0; i1 < convertList[Object.keys(convertList)[i]].length; i1++) {
            if (Object.keys(convertList)[i] == "value") highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(convertList)[i]][convertList[Object.keys(convertList)[i]][i1]] = document.getElementById(convertList[Object.keys(convertList)[i]][i1]).value;
            else highscores.normal[selected.pixelRate][selected.gegenstaende].settingsConverted[Object.keys(convertList)[i]][convertList[Object.keys(convertList)[i]][i1]] = document.getElementById(convertList[Object.keys(convertList)[i]][i1]).checked;
          }
        }
        */
        alert("Regeln: " + replaceAll(replaceAll(selected.settings, "false", "⛔"), "true", "✅"));
        if (gerät == "Handy" && confirm("Wollen sie mit Jo-Stick spielen?")) joyStickPlay.checked = true;
        resetLevel();
      }
    }
  }
  // function clickListCheck() {
  //   setTimeout(function () {
  //     var items = document.querySelectorAll("#db"),
  //     liIndex;
  //     tab = [];
  //            for(var i = 0; i < items.length; i++){
  //                tab.push(items[i].innerHTML);
  //            }
  //            for(i = 0; i < items.length; i++){
  //                items[i].onclick = function() {
  //                  textur.style.display = "inline";
  //                  x1 = 0;
  //                  y1 = 0;
  //                  window.scroll(9, 9);
  //                  if (gerät == "PC"/* || joyStickPlay.checked*/) {alert("please click to set a joy-stick!"); joyStick = "place";}
  //                  if (this.innerText == "create own pixel rate") {
  //
  //                  }
  //                  else selected.pixelRate = this.innerText;
  //                  // "brokenCheck: " + brokenCheck.checked + ", bounceWalls: " + bounceWalls.checked + ", stoppeBeiSpielzeug: " + stoppeBeiSpielzeug.checked + ", langsamerBeiSpielzeug: " + langsamerBeiSpielzeug.checked
  //
  //                }
  //              }
  //   }, 1000);
  // }
  // ball
  if (navigator.userAgent.match(/Android/i) ||
    navigator.userAgent.match(/webOS/i) ||
    navigator.userAgent.match(/iPhone/i) ||
    navigator.userAgent.match(/iPad/i) ||
    navigator.userAgent.match(/iPod/i) ||
    navigator.userAgent.match(/BlackBerry/i) ||
    navigator.userAgent.match(/Windows Phone/i)
  ) {
    var gerät = "Handy"
    console.log("Handy");
    sensibility.style.display = "none";
  } else {
    var gerät = "PC"
    joyStickPlayP.style.display = "none";
    console.log("PC");
  }
  sphere1.style.width = "50px";
  sphere1.style.height = "50px";
  var inOrAgainstDirection = 1;
  var selected = {pixelRate: window.innerWidth + " x " + window.innerHeight};
  var x1 = 300,
    y1 = 177; //window.innerHeight - 150 + 3,
  vx1 = 0, vy1 = 0,
    ax1 = 0, ay1 = 0;
  if (window.DeviceMotionEvent != undefined) {
    window.ondevicemotion = function(e) {
      ax1 = inOrAgainstDirection * event.accelerationIncludingGravity.x * 17;
      ay1 = inOrAgainstDirection * event.accelerationIncludingGravity.y * 17;
    }
  }
  else if (gerät == "Handy") {
    alert("Die seite muss als sicher (https am Anfang, im Moment http) aufgerufen werden, damit Bewegungssteuerung erlaubt wird! Sie können jedoch auch wenn die Website nicht sicher ist mit Joy-Stick spielen!");
    joyStickPlay.checked = true;
  }
  setInterval(function() {
    if (audio && audio.currentTime >= 2*60 + 31) {
      playCleanerSound();
    }
    if (selected.pixelRate) {
    textur.width = selected.pixelRate.toString().split(" x ")[0];
    textur.height = selected.pixelRate.toString().split(" x ")[1];
  }
    canvas.fillStyle = "#FF8000";
    canvas.fillRect(0, 0, textur.width, textur.height);
    // joy-stick:
    var nextCoordinates = {x: 0, y: 0};
    if (joyStickPlay.checked) {
      if (joyStick && joyStick.coordinates) var nextCoordinates = {x: x1 + (mausx - joyStick.coordinates.x)/JSON.parse(sensibility.value), y: y1 + (mausy - joyStick.coordinates.y)/JSON.parse(sensibility.value)};
    }
    else if (gerät == "Handy") var nextCoordinates = {x: parseInt(x1 + vx1 / cssToNumber(sphere1.style.width)), y: parseInt(y1 + vy1 / cssToNumber(sphere1.style.height))}
    // scrollingInterac.PC = true;
    // if (!scrollingInterac.user && sphere1.style.y > window.innerWidth + scrollX - 17*2*5) window.scroll(scrollX + 3, scrollY);
    // if (!scrollingInterac.user && sphere1.style.y > window.innerHeight + scrollY - 17*2*5) window.scroll(scrollX, scrollY + 3);
    // if (!scrollingInterac.user && sphere1.style.y - scrollX < (17*2 + sphere1.style.width*5) && scrollX > 2) window.scroll(scrollX - 3, scrollY);
    // if (!scrollingInterac.user && sphere1.style.y - scrollY < (17*2 + sphere1.style.height*5) && scrollY > 2) window.scroll(scrollX, scrollY - 3);
    // setTimeout(function () {
    //   scrollingInterac.PC = false;
    // }, 1);
    var landscapeOrientation = window.innerWidth / window.innerHeight > 1;
    if (landscapeOrientation) {
      vx1 = vx1 + ay1;
      vy1 = vy1 + ax1;
    } else {
      vy1 = vy1 - ay1;
      vx1 = vx1 + ax1;
    }
    vx1 = vx1 * 0.98;
    vy1 = vy1 * 0.98;
    var noMoebelInFront = true;
    for (var i = 0; selected.objects && i < selected.objects.moebel.length; i++) {
      var ball = {x: nextCoordinates.x, y: nextCoordinates.y, width: cssToNumber(sphere1.style.width), height: cssToNumber(sphere1.style.width)};
      if (isCollide(ball, selected.objects.moebel[i])) {
        noMoebelInFront = false;
      }
    }
    if (stopSpielzeug.boolean) {
      noMoebelInFront = false;
      stopSpielzeug.time -= 20;
      if (stopSpielzeug.time < 1) {
        stopSpielzeug.boolean = false;
        if (stopSpielzeug.clearing) slowDownSpielzeug = {boolean: false, time: "endless"};
      }
    }
    if (slowDownSpielzeug.boolean) {
    for (var i = 0; i < slowDownSpielzeug.time.length; i++) {
      if (slowDownSpielzeug.time[i] != "endless") {
        slowDownSpielzeug.time[i] -= 20;
        if (slowDownSpielzeug.time[i] < 1) {
          slowDownSpielzeug.speed += 0.1;//slowDownSpielzeug.boolean = false;
          slowDownSpielzeug.time.splice(i, 1);
          console.log("regain speed! speed now is " + slowDownSpielzeug.speed);
        }
      }
      if (slowDownSpielzeug.speed > 1.9) {
        slowDownSpielzeug.boolean = false;
        console.log("original speed reached");

      }
    }
  }
    if (noMoebelInFront && inRound) {
      if (y1 > nextCoordinates.y) {direction.y = -1; speed.y = y1 - nextCoordinates.y}
      else {direction.y = 1; speed.y = nextCoordinates.y - y1};
      if (x1 > nextCoordinates.x) {direction.x = -1; speed.x = x1 - nextCoordinates.x;}
      else {direction.x = 1; speed.x = nextCoordinates.x - x1;}
      if (speed.x > speed.y) {speed.highest = {number: speed.x, direction: "x"};}
      else speed.highest = {number: speed.y, direction: "y"};
      y1 = nextCoordinates.y;
      x1 = nextCoordinates.x;//parseInt(x1 + vx1 / cssToNumber(sphere1.style.width));
      // if (joyStick && joyStick.coordinates) {
      //   x1 += (mausx - joyStick.coordinates.x)/JSON.parse(sensibility.value); //25;
      //   y1 += (mausy - joyStick.coordinates.y)/JSON.parse(sensibility.value); //25;
      // }
      verfallsdaten.ladung -= speed.x + speed.y;
    }
    if (slowDownSpielzeug.boolean && !stopSpielzeug.boolean) slowDown(slowDownSpielzeug.speed);
    boundingBoxCheck();
    sphere1.style.top = y1 + "px";
    sphere1.style.left = x1 + "px";
    for (var i = 0; selected.objects && i < selected.objects.teppich.length; i++) {
      canvas.fillStyle = "green";
      canvas.fillRect(selected.objects.teppich[i].x, selected.objects.teppich[i].y, selected.objects.teppich[i].width, selected.objects.teppich[i].height);
      canvas.fillStyle = "#2EFE2E";
      canvas.fillRect(selected.objects.teppich[i].x + 11, selected.objects.teppich[i].y + 11, selected.objects.teppich[i].width - 22, selected.objects.teppich[i].height - 22);
      speed.slowDownFinished = false;
      var teppichRamen = {x: selected.objects.teppich[i].x, y: selected.objects.teppich[i].y, width: selected.objects.teppich[i].width, height: 11}
      var ball = {x: x1, y: y1, width: cssToNumber(sphere1.style.width), height: cssToNumber(sphere1.style.width)};
      if (isCollide(teppichRamen, ball) && !speed.slowDownFinished) slowDown(JSON.parse(verlangsamungTeppich.value)/10);
      var teppichRamen = {x: selected.objects.teppich[i].x, y: selected.objects.teppich[i].y, height: selected.objects.teppich[i].height, width: 11}
      if (isCollide(teppichRamen, ball) && !speed.slowDownFinished) slowDown(JSON.parse(verlangsamungTeppich.value)/10);
      var teppichRamen = {x: selected.objects.teppich[i].x + selected.objects.teppich[i].width - 11, y: selected.objects.teppich[i].y, height: selected.objects.teppich[i].height, width: 11}
      if (isCollide(teppichRamen, ball) && !speed.slowDownFinished) slowDown(JSON.parse(verlangsamungTeppich.value)/10);
      var teppichRamen = {x: selected.objects.teppich[i].x, y: selected.objects.teppich[i].y + selected.objects.teppich[i].height - 11, height: 11, width: selected.objects.teppich[i].width}
      if (isCollide(teppichRamen, ball) && !speed.slowDownFinished) slowDown(JSON.parse(verlangsamungTeppich.value)/10);
    }
    if (verfallsdaten.ladung < 1 && JSON.parse(anzahlLadestationen.value) > 0) {
      inRound = false;
      try {
        audio.pause();
      } catch (e) {

      }
      verfallsdaten.ladung = selected.maxVerfallsdaten.ladung;
      audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/vacuum-cleaner-sound-effect-youtubemp3free.org.mp3");
      audio.currentTime = 2*60 + 33;
      audio.play();
      setTimeout(function () {
        resetLevel("Akku leer!!!");
      }, 3000);
     }
    for (var i = 0; selected.objects && i < selected.objects.moebel.length; i++) {
      canvas.fillStyle = "#FACC2E";
      canvas.fillRect(selected.objects.moebel[i].x, selected.objects.moebel[i].y, selected.objects.moebel[i].width, selected.objects.moebel[i].height);
      // if (!((x1 >= selected.objects.moebel[i].x && x1 < selected.objects.moebel[i].x + selected.objects.moebel[i].width) || (y1 >= selected.objects.moebel[i].y && y1 < selected.objects.moebel[i].y + selected.objects.moebel[i].height) || (x1 <= selected.objects.moebel[i].x + selected.objects.moebel[i].width && x1 > selected.objects.moebel[i].x) || (x1 <= selected.objects.moebel[i].x + selected.objects.moebel[i].width && x1 > selected.objects.moebel[i].x)))
      // if (y1 >= selected.objects.moebel[i].y && y1 < selected.objects.moebel[i].y + selected.objects.moebel[i].height)
      // if (x1 <= selected.objects.moebel[i].x + selected.objects.moebel[i].width && x1 > selected.objects.moebel[i].x)
      // if (x1 <= selected.objects.moebel[i].x + selected.objects.moebel[i].width && x1 > selected.objects.moebel[i].x)
    }
    for (var i = 0; selected.objects && i < selected.objects.vertiefung.length; i++) {
      canvas.fillStyle = "black";
      canvas.fillRect(selected.objects.vertiefung[i].x, selected.objects.vertiefung[i].y, selected.objects.vertiefung[i].width, selected.objects.vertiefung[i].height);
      var ball = {x: x1, y: y1, width: 5, height: 5};
      // if (speed.highest.direction == "x") ball.x = ball.x + (ball.width) - (ball.width/2)*direction.x;
      // else ball.y = ball.y + (ball.height/2) - (ball.height)*direction.y;
      // canvas.fillStyle = "blue";
      // canvas.fillRect(ball.x, ball.y, 22, 22);
      if (speed.highest.direction == "x") ball.x += cssToNumber(sphere1.style.width)/2//2*(-direction.x)
      else ball.y += cssToNumber(sphere1.style.width)/2//ball.height/2*(-direction.y) + ball.height*2;
      // canvas.fillStyle = "red";
      // canvas.fillRect(ball.x, ball.y, ball.width, 100);
      if (isCollide(ball, selected.objects.vertiefung[i])) {
        resetLevel("ab ins Loch!!!");
      }
      // if (x1 > selected.objects.vertiefung[i].x + selected.objects.vertiefung[i].width/2 && x1 < selected.objects.vertiefung[i].x + selected.objects.vertiefung[i].width && y1 > selected.objects.vertiefung[i].y && y1 < selected.objects.vertiefung[i].y + selected.objects.vertiefung[i].height) {
      //   console.log("going down from left");
      // }
      // if (x1 < selected.objects.vertiefung[i].x + selected.objects.vertiefung[i].width/2 && x1 > selected.objects.vertiefung[i].x && y1 > selected.objects.vertiefung[i].y && y1 < selected.objects.vertiefung[i].y + selected.objects.vertiefung[i].height) {
      //   console.log("going down from right");
      // }
      // if (y1 > selected.objects.vertiefung[i].y + selected.objects.vertiefung[i].height/2 && y1 < selected.objects.vertiefung[i].y + selected.objects.vertiefung[i].height && x1 > selected.objects.vertiefung[i].x && x1 < selected.objects.vertiefung[i].x + selected.objects.vertiefung[i].width) {
      //   console.log("going down from up");
      // }
      // if (y1 < selected.objects.vertiefung[i].y + selected.objects.vertiefung[i].height/2 && y1 > selected.objects.vertiefung[i].y && x1 > selected.objects.vertiefung[i].x && x1 < selected.objects.vertiefung[i].x + selected.objects.vertiefung[i].width) {
      //   console.log("going down from down");
      // }
    }
    var allStaubCollected = true;
    var ball = {x: x1, y: y1, width: cssToNumber(sphere1.style.width), height: cssToNumber(sphere1.style.width)};
    if (!selected.objects) allStaubCollected = false;
    for (var i = 0; selected.objects && i < selected.objects.ladestation.length; i++) {
      canvas.fillStyle = "green";//"#2EFE2E";
      canvas.fillRect(selected.objects.ladestation[i].x, selected.objects.ladestation[i].y, selected.objects.ladestation[i].width, selected.objects.ladestation[i].height);
      if (showWayLadestation.checked || (verfallsdaten.ladung < window.innerWidth + window.innerHeight/5 && showWayLaderWhenLow.checked)) {
        canvas.strokeStyle = "green";
        canvas.beginPath();
        canvas.moveTo(selected.objects.ladestation[i].x, selected.objects.ladestation[i].y);
        canvas.lineTo(x1, y1);
        canvas.stroke();
        canvas.closePath();
      }
      if (isCollide(ball, selected.objects.ladestation[i]) && verfallsdaten.ladung < selected.maxVerfallsdaten.ladung/*177*/) verfallsdaten.ladung += 17;
    }
    for (var i = 0; selected.objects && i < selected.objects.leererStation.length; i++) {
      canvas.fillStyle = "#A4A4A4";
      canvas.fillRect(selected.objects.leererStation[i].x, selected.objects.leererStation[i].y, selected.objects.leererStation[i].width, selected.objects.leererStation[i].height);
      if (showWayEntleerer.checked || (verfallsdaten.füllungLeft < 222 && showWayEntleererWhenLow.checked)) {
        canvas.strokeStyle = "#A4A4A4";
        canvas.lineWidth = 4;
        canvas.beginPath();
        canvas.moveTo(selected.objects.leererStation[i].x, selected.objects.leererStation[i].y);
        canvas.lineTo(x1, y1);
        canvas.stroke();
        canvas.closePath();
      }
      if (isCollide(ball, selected.objects.leererStation[i]) && verfallsdaten.füllungLeft < /*133*/selected.maxVerfallsdaten.füllungLeft) verfallsdaten.füllungLeft += 3;
    }
    for (var i = 0; selected.objects && i < selected.objects.staub.length; i++) {
      // collect staub
      if (verfallsdaten.füllungLeft > selected.objects.staub[i].radius*2 && !selected.objects.staub[i].collected && selected.objects.staub[i].x > x1 + 8 && selected.objects.staub[i].x + selected.objects.staub[i].radius < x1 + 8 + cssToNumber(sphere1.style.width) && selected.objects.staub[i].y > y1 + 8 && selected.objects.staub[i].y + selected.objects.staub[i].radius < y1 + 8 + cssToNumber(sphere1.style.width)) {
        selected.objects.staub[i].collected = true;
        verfallsdaten.füllungLeft -= selected.objects.staub[i].radius*2;
        if (verfallsdaten.füllungLeft < 1 && JSON.parse(anzahlEntleerer.value) > 0) {console.log("Sauger voll! Keinen neuen Staub mehr aufnehmen!!!");}
        audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/knistern-crackle-rascheln-rustle-gerusche-noise-audio-klnge-hd-soundeffekte-youtubemp3free.mp3");
        audio.volume = 1;
        //audio.currentTime = 1;
        audio.play();
        // setTimeout(function () {
        //   audio.pause();
        // }, 777);
      }
      canvas.fillStyle = "#A4A4A4";
      canvas.globalAlpha = 1;
      if (!(verfallsdaten.füllungLeft > selected.objects.staub[i].radius*2)) canvas.globalAlpha = 0.5;
      canvas.beginPath();
      canvas.arc(selected.objects.staub[i].x, selected.objects.staub[i].y, selected.objects.staub[i].radius, 0, Math.PI*2, false);
      if (!selected.objects.staub[i].collected) {
        canvas.fill();
        allStaubCollected = false;
      }
    }
    if (allStaubCollected == true && (syncFinished == true || syncFinished == "beginning")) {
      console.log("finished!!!");
      if (syncFinished != true) {syncFinished = "inProgress";getDatabase(true);}
      // else {
      //   if (syncFinished == "beginning") syncFinished = false;
      //   setTimeout(function () {
      //     syncFinished = false;
      //   }, 1);
      // }
      if (syncFinished == true) {
        if (!highscores.normal[selected.pixelRate][selected.gegenstaende].highscores) highscores.normal[selected.pixelRate][selected.gegenstaende].highscores = {};
        if (!highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name]) highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name] = {};
        if (!highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name][gerät]) highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name][gerät] = {};
        if (!highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name][gerät][(joyStickPlay.checked + "").replace("true", "joy-stick").replace("false", "no joy-stick")] || mins + ":" + secs + ":" + "0" + tenths < highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name][gerät][joyStickPlay.checked]) {
          highscores.normal[selected.pixelRate][selected.gegenstaende].highscores[name][gerät][(joyStickPlay.checked + "").replace("true", "joy-stick").replace("false", "no joy-stick")] = mins + ":" + secs + ":" + "0" + tenths;
          if (!offline) dbSetWarteschlange.push({tag: "highscores", data: highscores});
          else {
            var newHighscores = [];
            if (localStorage.getItem("newHighscores")) newHighscores = JSON.parse(localStorage.getItem("newHighscores"));
            newHighscores.push({pixelRate: selected.pixelRate, gegenstaende: selected.gegenstaende, gerät: selected.gerät, joyStick: (joyStickPlay.checked + "").replace("true", "joy-stick").replace("false", "no joy-stick"), data: mins + ":" + secs + ":" + "0" + tenths});
            localStorage.setItem("newHighscores", JSON.stringify(newHighscores));
          }
          alert("So schnell haben sie noch nie gesaugt!!!");
        }
        if (confirm("Wollen sie sich die Leistungen der anderen Spieler ansehen?")) {
          var highscoresShow = JSON.parse(JSON.stringify(highscores.normal[selected.pixelRate][selected.gegenstaende].highscores));
          for (var i = 0; i < Object.keys(highscoresShow).length; i++) {
            if (!highscoresShow[Object.keys(highscoresShow)[i]].Handy) highscoresShow[Object.keys(highscoresShow)[i]].Handy = {};
            highscoresShow[Object.keys(highscoresShow)[i]] = {"PC with joy-stick": highscoresShow[Object.keys(highscoresShow)[i]].PC["joy-stick"], "Handy with joy-stick": highscoresShow[Object.keys(highscoresShow)[i]].Handy["joy-stick"], "Handy without joy-stick": highscoresShow[Object.keys(highscoresShow)[i]].Handy["no joy-stick"]};
          }
          showScores(highscoresShow);
        }
        syncFinished = false;
      }
    }
    canvas.globalAlpha = 1;
    for (var i = 0; selected.objects && i < selected.objects.spielzeug.length; i++) {
      // collect spielzeug
      if (!selected.objects.spielzeug[i].collected && ((!spielzeugWenigPlatz.checked && verfallsdaten.füllungLeft > selected.objects.spielzeug[i].radius*2) || spielzeugWenigPlatz.checked) && selected.objects.spielzeug[i].x > x1 + 8 && selected.objects.spielzeug[i].x + selected.objects.spielzeug[i].radius < x1 + 8 + cssToNumber(sphere1.style.width) && selected.objects.spielzeug[i].y > y1 + 8 && selected.objects.spielzeug[i].y + selected.objects.spielzeug[i].radius < y1 + 8 + cssToNumber(sphere1.style.width)) {
        selected.objects.spielzeug[i].collected = true;
        if (verfallsdaten.füllungLeft > selected.objects.spielzeug[i].radius*2 && !spielzeugPlatz.checked) verfallsdaten.füllungLeft -= selected.objects.spielzeug[i].radius*2;
        if (stoppeBeiSpielzeug.checked) stopSpielzeug = {boolean: true, time: 2000};
        if (langsamerBeiSpielzeug.checked && !slowDownSpielzeug.boolean) slowDownSpielzeug = {boolean: true, time: [JSON.parse(zeitLangsamer.value)], speed: 1.9};
        else if (langsamerBeiSpielzeug.checked && slowDownSpielzeug.speed - 0.1 >= 1.1) {slowDownSpielzeug.speed -= 0.1; slowDownSpielzeug.time.push(JSON.parse(zeitLangsamer.value));}
        else if (langsamerBeiSpielzeug.checked) {
          if (restartWhenSlow.checked) resetLevel();
          if (clearWhenSlow.checked) stopSpielzeug = {boolean: true, time: 2000, clearing: true};
        }
        /*
        if (slowDownSpielzeug.boolean && ) {slowDown(slowDownSpielzeug.speed - 0.1); slowDownSpielzeug.speed -= 1.1;}
        else if (slowDownSpielzeug.boolean) slowDown(slowDownSpielzeug.speed);
        */
        var audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/seth-hoovers-up-his-lego-youtubemp3free.org.mp3");
        audio.currentTime = 48; audio.play();
        setTimeout(function () {
          audio.pause();
        }, 500);
        // verfallsdaten.füllungLeft -= selected.objects.spielzeug[i].radius*2;
        // if (verfallsdaten.füllungLeft < 1) console.log("Sauger voll! Keinen neuen spielzeug mehr aufnehmen!!!");
      }
      canvas.fillStyle = "red";
      canvas.beginPath();
      canvas.arc(selected.objects.spielzeug[i].x, selected.objects.spielzeug[i].y, selected.objects.spielzeug[i].radius, 0, Math.PI*2, false);
      if (!selected.objects.spielzeug[i].collected) {
        canvas.fill();
      }
    }
    for (var i = 0; selected.objects && i < selected.objects.schmuck.length; i++) {
      // collect Schmuck
      if (!selected.objects.schmuck[i].collected && selected.objects.schmuck[i].x > x1/* + 8*/ && selected.objects.schmuck[i].x + selected.objects.schmuck[i].radius < x1/* + 8*/ + cssToNumber(sphere1.style.width) && selected.objects.schmuck[i].y > y1/* + 8*/ && selected.objects.schmuck[i].y + selected.objects.schmuck[i].radius < y1/* + 8*/ + cssToNumber(sphere1.style.width)) {
        selected.objects.schmuck[i].collected = true;
        audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/vacuuming-up-random-stuff-floor-tool-vacuum-cleaner-sound-asmr-youtubemp3free.org.mp3");
        audio.currentTime = 60*1 + 29.5;
        audio.play();
        setTimeout(function () {
          audio.pause();
          audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/you%20are%20fired!.mp3").play();
          resetLevel(/*"Schmuck eingesammelt!"*/);
        }, 500);
      }
      canvas.fillStyle = "yellow";
      canvas.beginPath();
      canvas.arc(selected.objects.schmuck[i].x, selected.objects.schmuck[i].y, selected.objects.schmuck[i].radius, 0, Math.PI*2, false);
      if (!selected.objects.schmuck[i].collected) {
        canvas.fill();
      }
    }
    // sphere1.style.top = "175";
    // sphere1.style.left = "9";
    // energyBar.style.left = "20";
    // energyBar.style.top = "180";
    // trashBar.style.left = "37";
    // trashBar.style.top = "180";
    // setTimeout(function () {
    //   energyBar.style.height = 30;
    //   energyBar.style.top = "190";
    // }, 3333);
    if (selected.maxVerfallsdaten) {
    energyBar.style.width = 11 + (cssToNumber(sphere1.style.width) - 50)/2;
    energyBar.style.height = 40 + (cssToNumber(sphere1.style.height) - 50);
    trashBar.style.width = 11 + (cssToNumber(sphere1.style.width) - 50)/2;
    trashBar.style.height = 40 + (cssToNumber(sphere1.style.height) - 50);
    energyBar.style.height = cssToNumber(energyBar.style.height)*(verfallsdaten.ladung/ /*177*/selected.maxVerfallsdaten.ladung);
    trashBar.style.height = cssToNumber(trashBar.style.height)*(verfallsdaten.füllungLeft/ selected.maxVerfallsdaten.füllungLeft/*133*/);

    energyBar.style.left = cssToNumber(sphere1.style.left) + 11// + cssToNumber(sphere1.style.width) - 50;
    energyBar.style.top = cssToNumber(sphere1.style.top) + 5 + (40 - cssToNumber(energyBar.style.height)) + cssToNumber(sphere1.style.height) - 50;
    trashBar.style.left = cssToNumber(sphere1.style.left) + 28 + cssToNumber(trashBar.style.width)//cssToNumber(sphere1.style.width) - 50;
    trashBar.style.top = cssToNumber(sphere1.style.top) + 5 + (40 - cssToNumber(trashBar.style.height)) + cssToNumber(sphere1.style.height) - 50;
  }
  if (joyStick && joyStick.coordinates) {
    canvas.fillStyle = "blue";
    canvas.beginPath();
    canvas.arc(joyStick.coordinates.x, joyStick.coordinates.y, 10, 0, Math.PI*2, false);
    canvas.fill();
    canvas.strokeStyle = "green";
    canvas.beginPath();
    canvas.moveTo(joyStick.coordinates.x, joyStick.coordinates.y);
    canvas.lineTo(mausx, mausy);
    canvas.stroke();
    canvas.closePath();
  }
  }, 25);
  var audio;
  var inRound = false;
  function playCleanerSound() {
    try {
      audio.pause();
    } catch (e) {}
    audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/low%20pitch-shifted-vacuum-cleaner-without-piep-sound-effect-youtubemp3free.mp3"/*"https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/low%20pitch-shifted-vacuum-cleaner-sound-effect-youtubemp3free.mp3"*//*"https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/pitch-shifted-vacuum-cleaner-sound-effect-youtubemp3free.org.mp3"*/ /*"https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/vacuum-cleaner-sound-effect-youtubemp3free.org.mp3"*/);
    if (clenerFiepAudio.checked) audio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/low%20pitch-shifted-vacuum-cleaner-little-piep-sound-effect-youtubemp3free.mp3");
    audio.volume = 0.5;
    audio.currentTime = 1;
    if (cleanerAudio.checked) audio.play();
  }
  function resetLevel(type) {
    setTimeout(function () {
      window.scroll(9, 9);
    }, 500);
    textur.style.touchAction = 'none';
    time = 0;
    textur.style.display = "inline";
    if (gerät == "PC" && (!joyStick || !joyStick.coordinates)/* || joyStickPlay.checked*/) {joyStickPlay.checked = true; alert("please click to set a joy-stick!"); joyStick = "place";}
    if (type) console.log(type);
    inRound = true;
    try {
      audio.pause();
    } catch (e) {}
    if (type != "Akku leer!!!" && type != undefined) {
      var localAudio = new Audio("https://adi.nicolaiweitkemper.de/Sounds/cleanTheRoom/wall-hit-sound-effects-all-sounds-2-youtubemp3free.org.mp3");
      localAudio.currentTime = 29.5;
      localAudio.play();
      setTimeout(function () {
        localAudio.pause();
      }, 1000);
    }
    playCleanerSound();
    verfallsdaten = {ladung: selected.maxVerfallsdaten.ladung, füllungLeft: /*133*/selected.maxVerfallsdaten.füllungLeft};
    slowDownSpielzeug = {boolean: false, time: "endless"}
    setTimeout(function () {
      x1 = 0;
      y1 = 0;
      for (var i = 0; i < selected.objects.staub.length; i++) {
        selected.objects.staub[i].collected = false;
      }
      for (var i = 0; i < selected.objects.spielzeug.length; i++) {
        selected.objects.spielzeug[i].collected = false;
      }
      for (var i = 0; i < selected.objects.schmuck.length; i++) {
        selected.objects.schmuck[i].collected = false;
      }
    }, 1);
  }
  var stopSpielzeug = {time: 0, boolean: false};
  var slowDownSpielzeug = {time: 0, boolean: false};
  var speed = {x: 0, y: 0, highest: 0};
  var direction = {x: 1, y: 1};
  function isCollide(a, b) {
    if (a.radius) {a.height = a.radius*2; a.x -= JSON.parse(JSON.stringify(a.radius)); a.y -= JSON.parse(JSON.stringify(a.radius));}
    if (b.radius) {b.height = b.radius*2; b.x -= JSON.parse(JSON.stringify(b.radius)); b.y -= JSON.parse(JSON.stringify(b.radius));}
    return !(
      ((a.y + a.height) < (b.y)) ||
      (a.y > (b.y + b.height)) ||
      ((a.x + a.width) < b.x) ||
      (a.x > (b.x + b.width))
    );
  }
  function slowDown(pSpeed) {
    console.log("slow down");
    //if (!pSpeed) var pSpeed = "Test";
    y1 -= speed.y/ /*1.1*/ pSpeed*direction.y;
    x1 -= speed.x/ pSpeed/*1.3*/ *direction.x;
    sphere1.style.top = y1 + "px";
    sphere1.style.left = x1 + "px";
    speed.slowDownFinished = true;
    verfallsdaten.ladung += speed.y/1.1 + speed.x/1.3;
  }
  var syncFinished = "beginning";
  function boundingBoxCheck() {
    if (x1 < 0) {
      if (speed.highest.number > 5 && brokenCheck.checked) {resetLevel("broken");}
      x1 = 0;
      if (bounceWalls.checked) vx1 = -vx1;
    }
    if (y1 < 0) {
      if (speed.highest.number > 5 && brokenCheck.checked) {resetLevel("broken");}
      y1 = 0;
      if (bounceWalls.checked) vy1 = -vy1;
    }
    if (x1 > selected.pixelRate.toString().split(" x ")[0] - JSON.parse(sphere1.style.width.toString().split('px')[0]) / 2) {
      if (speed.highest.number > 5 && brokenCheck.checked) {resetLevel("broken");}
      x1 = /*window.innerWidth*/selected.pixelRate.toString().split(" x ")[0] - JSON.parse(sphere1.style.width.toString().split('px')[0]) / 2 - 1;
      if (bounceWalls.checked) vx1 = -vx1;
    }
    if (y1 > selected.pixelRate.toString().split(" x ")[1] - JSON.parse(sphere1.style.height.toString().split('px')[0]) / 2) {
      if (speed.highest.number > 5 && brokenCheck.checked) {resetLevel("broken");}
      y1 = selected.pixelRate.toString().split(" x ")[1] - JSON.parse(sphere1.style.height.toString().split('px')[0]) / 2;
      if (bounceWalls.checked) vy1 = -vy1;
    }
  }
  var verfallsdaten = {ladung: 177, füllungLeft: 133};
  function cssToNumber(string) {
    return JSON.parse(string.toString().split("px")[0]);
  }
  function canvasClicked() {
    if (joyStick == "place" && gerät == "PC") {
      joyStick = {coordinates : {x: mausx, y: mausy}};
    }
  }
  var mausx;
  var mausy;
  function readMouseMove(e) {
    mausx = e.clientX + scrollX;
    mausy = e.clientY + scrollY;
  }
  document.onmousemove = readMouseMove
  document.addEventListener('touchmove', touch);
  document.addEventListener('touchstart', touch);
  document.addEventListener('touchend', touch);
// }
function touch(ev) {
  // if (!ev.touches[0]) {
  //   console.log(":((()))");
  // }
    if (joyStickPlay.checked && ev.touches[0] != undefined) {
      mausx = ev.touches[0]["pageX"]// + scrollX;
      mausy = ev.touches[0]["pageY"]// + scrollY;
    }
  if (joyStickPlay.checked && ev.type == "touchend") {
    //textur.style.touchAction = '';
    mausx = joyStick.coordinates.x;
    mausy = joyStick.coordinates.y;
  }
    if (joyStickPlay.checked && ev.type == "touchstart") {
      joyStick = {coordinates : {x: mausx, y: mausy}};
      textur.style.touchAction = 'none';
    }
    // if (ev.type == "touchmove") {
    //   mousemoveFolgen();
    // }
}
function replaceAll(str, find, replace) {
    return str.replace(new RegExp(find, 'g'), replace);
}
// topp uhr
var time = 0;
// var running = 0;
var mins;
var secs;
var tenths;
increment();

// function startPause() {
// if (running == 0) {
//   running = 1;
//   time = 0;
//   increment();
// }
// else {
//   running = 0;
// }
// }
// function reset() {
// running = 0;
// timer = 0;
// }
function increment() {
// if (running == 1) {
setTimeout(function () {
  time++;
  mins = Math.floor(time/10/60);
  secs = Math.floor(time/10);
      secs -= 60*mins;
  tenths = time % 10;
  if (mins < 10) {
    mins = "0" + mins
  }
  if (secs < 10) {
    secs = "0" + secs;
  }
  increment();
}, 100);
// }
}
var highscoresDisplayedBefore = {};
function showScores(highscores, mode) {
  scores.style.display = "inline";
  for (var i = 0; i < Object.keys(highscoresDisplayedBefore).length + 11 && Object.keys(highscoresDisplayedBefore).length > 0; i++) {
    try {
      document.getElementById("scores").deleteRow(0);
    } catch (e) {
      console.log("wanted to delete too many elements of table");
      i = Object.keys(highscoresDisplayedBefore).length + 11
    }
  }
  highscoresDisplayedBefore = highscores;
  document.getElementById('textur').style.display = "none";
  //console.log("scores: " + highscores);
  var cell = [ /*row.insertCell(0)*/ ];
  var highestLives = {lives: 0, number: 3};
  for (var i = 0; i < Object.keys(highscores).length; i++) {
    // if (!(Object.keys(highscores)[i] == "allMaps")) {
      var table = document.getElementById("scores");
      var row = table.insertRow(i);
      cell.push(row.insertCell(0));
      cell[cell.length - 1].innerHTML = Object.keys(highscores)[i]
    // }
    //  var cell = [/*row.insertCell(0)*/];
    for (var i1 = 1; i1 < Object.keys(highscores[Object.keys(highscores)[i]]).length + 1; i1++) {
      // if (!(Object.keys(highscores)[i] == "allMaps")) {
        if (i1 < Object.keys(highscores[Object.keys(highscores)[i]]).length + 1) {
          cell[cell.length - 2] = row.insertCell(i1);
          // if (level[level.mode].levelType == "worldWideLevel" && i1 == 0) {
          //   i1--;
          // }
          if (highscores[Object.keys(highscores)[i]][Object.keys(highscores[Object.keys(highscores)[i]])[i1 - 1]] != undefined) cell[cell.length - 2].innerHTML = highscores[Object.keys(highscores)[i]][Object.keys(highscores[Object.keys(highscores)[i]])[i1 - 1]];
          else cell[cell.length - 2].innerHTML = "/";
          if (highscores[Object.keys(highscores)[i]][Object.keys(highscores[Object.keys(highscores)[i]])[i1 - 1]] >  highscores[Object.keys(highscores)[i]][Object.keys( highscores[Object.keys(highscores)[i]])[i1/* - 1*/]]) cell[cell.length - 2].style.color = "red";
          else if (highscores[Object.keys(highscores)[i]][Object.keys(highscores[Object.keys(highscores)[i]])[i1 - 1]] <  highscores[Object.keys(highscores)[i]][Object.keys( highscores[Object.keys(highscores)[i]])[i1/* - 1*/]]) cell[cell.length - 2].style.color = "green";
          else if (name == Object.keys(highscores)[i]) cell[cell.length - 2].style.color = "blue";
          else cell[cell.length - 2].style.color = "black";

        } else {
          cell[cell.length - 2] = row.insertCell(i1);
          //  cell[cell.length - 2].innerHTML = "unmade";
          //  cell[cell.length - 2].style.color = "black";
        }
      // }
    }
    var row = table.insertRow(i);
    //  var row = table.insertRow(i+1);
    // var row = table.insertRow(i + 1);
    if (Object.keys(highscores[Object.keys(highscores)[i]]).length > highestLives.lives) highestLives = {number: i, lives: Object.keys(highscores[Object.keys(highscores)[i]]).length}
  }
  //  var row = table.insertRow(0);
  //  var cell = [/*row.insertCell(0)*/];
  // cell.push(row.insertCell(0));
  // cell[cell.length - 1].innerHTML = "name";
  var row = table.insertRow(0);
  cell.push(row.insertCell(0));
  for (var i1 = 0; i1 < highestLives.lives + 1; i1++) {
    cell.push(row.insertCell(i1));
    if (i1 == 0) cell[cell.length - 1].innerHTML = "name";
    else cell[cell.length - 1].innerHTML = Object.keys(highscoresShow[name])[i1 - 1];
  }
}
</script>
