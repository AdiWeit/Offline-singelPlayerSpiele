<meta charset="utf-8">
<title>protect the room</title>
<div id="space_key">space key/<br>(left) click</div>
<canvas id="textur" width="300" height="300"></canvas>
<div id="settings">
  <input id="useMultAmmo" checked="true" type="checkbox"> ammo tactive
  <input id="tutorialCheck" type="checkbox">tutorial
  <button onclick="startGame(tutorialCheck.checked); settings.style.display = 'none';">start</button>
</div>
<body>
<div id="spacePlayer" style="position: absolute; top: -9999px; left: -9999px;"></div>
<div id="fightPlayer" style="position: absolute; top: -9999px; left: -9999px;"></div>
<input checked="true" id="spaceMusicCheck" type="checkbox" onchange="if (checked) playerObj.space.playVideo(); else playerObj.space.pauseVideo(); localStorage.setItem('spaceMusic', checked);">play space music
<input type="checkbox" onchange="if (checked) {playerObj.fight.seekTo(Math.round(Math.random()*36048));  playerObj.fight.playVideo();} else playerObj.fight.pauseVideo();">play fight music
<script src="https://www.youtube.com/player_api"></script>
<style>
  #space_key {
  background-color: rgba(255, 0, 0, 0.5);
  width: 555px;
  height: 150px;
  border: 3px solid rgba(255, 255, 255, 0.2);
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  font-size: 60px;
  text-align: center;
  display: none;

  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
</style>
<br>
<div>Icon made from <a href="http://www.onlinewebfonts.com/icon">Icon Fonts</a> is licensed by CC BY 3.0</div>
<script>
  var swipeStr = "";
  if (localStorage.getItem('spaceMusic') == "false") spaceMusicCheck.checked = false;
  if (navigator.userAgent.match(/Android/i) ||
    navigator.userAgent.match(/webOS/i) ||
    navigator.userAgent.match(/iPhone/i) ||
    navigator.userAgent.match(/iPad/i) ||
    navigator.userAgent.match(/iPod/i) ||
    navigator.userAgent.match(/BlackBerry/i) ||
    navigator.userAgent.match(/Windows Phone/i)
  ) {
    var ger채t = "Handy";
    swipeStr = "swipe_";
  }
  else var ger채t = "PC";
  console.log(ger채t);
  var wHeight = window.innerHeight;
  var newCannon;
  var speed ;
  var lives;
  var highscores = {};
  var name = "Adron";
  var phase = {name: "normal"}
  class Player {
    constructor() {
    this.position = wHeight/2;
    this.bullets = {max: 1, got: []};
    this.speed = 10;
    if (ger채t == "Handy") this.speed = 15;
    this.selectedBullet = 0;
    }
    shoot = (bullet) => {
      try {
        if (tutorial.status == "no" || tutorial.status.includes("shoot")) {
        if (tutorial.status == "shoot" && bullet) {
          space_key.style.fontSize = "120px";
          space_key.innerHTML = 'collect';
          // space_key.style.display = "none";
          setTimeout(function () {
            tutorial.status = "collectAmmo";
            tutorial.counter = 0;
            player.bullets.max++;
            bullets.push({speed: 6, x: 33, y: window.innerHeight/3 - 133, width: 133, height: 133, direction: {x: 1, y: 0}});
            setTimeout(function () {
              bullets.push({speed: 5, x: 33, y: 33, width: 50, height: 50, direction: {x: 1, y: 0}});
              setTimeout(function () {
                if (tutorial.status == "collectAmmo") {
                  restartTutorial();
                }
              }, 5000);
            }, 3333);
          }, 4000);
        }
        console.log("shoot!");
        bullet = JSON.parse(JSON.stringify(player.bullets.got[player.selectedBullet]));
        if (bullet) new Audio('https://adi.nicolaiweitkemper.de/Sounds/protectTheRoom/shot.wav').play();
        // bullet.y = this.position - bullet.height;
        bullet.speed += 5;
        bullets.push(JSON.parse(JSON.stringify(bullet)));
        player.bullets.got.splice(player.selectedBullet, 1);
        if (player.selectedBullet == player.bullets.got.length && player.selectedBullet > 0) player.selectedBullet--;
        player.reload = {index: player.selectedBullet, left: 333};
        player.selectedBullet = -1;
      }
      } catch (e) {
        console.log("can not shoot (no ammo?)");
      }
  }
}
  var tutorial = {status: 'no'};
  var player = new Player();
  function startGame(pTutorial) {
    space_key.style.display = "none";
    space_key.style.fontSize = 60;
    newCannon = {time: {needed: convertNumber*5, got: convertNumber*5 - 16}, counter: 0}
    speed = {bullet: 3, cannon: 1777, minTime: 1777};
    lives = {beginning: 133, now: 133};
    phase = {name: "normal"};
    player = new Player();
    cannons = [];
    bullets = [];
    tutorial = {status: 'no'};
    if (pTutorial) tutorial = {status: 'moveDown'};
    disableScroll();
    window.scroll(0, 0);
    // newCannon.time.needed = wHeight*1.7//3;
    // player.speed = 33;
    // player.bullets.max = 6;
    // speed.bullet = 11;
    // reloadAmmo max
    // newCannon.time.needed -= wHeight*1.5//3;
    // newCannon.time.needed = wHeight*5 - wHeight*1.5//3;
    // player.speed = 33;
    // player.bullets.max = 6;
    // speed.bullet = 3;
    // // speed.minTime = 999;
    // evenFaster max:
    // newCannon.time.needed = convertNumber *1.2//3;
    // player.speed = adaptToHeight(89);
    // player.bullets.max = 6;
    // speed.bullet = 11;
    // requestAnimationFrame(animateBullet);
    // evenFaster max:
    // newCannon.time.needed = convertNumber *1//3;
    // player.speed = adaptToHeight(99);
    // player.bullets.max = 6;
    // speed.bullet = 13;
    requestAnimationFrame(animateBullet);
    space_key.innerHTML = 'space key/<br>(left) click';
    if (pTutorial) {
      cannons.push({x: 33, y: window.innerHeight - 50 - (133*(((window.innerWidth*wHeight)/(1600*1069)))*1.7), width: 133, height: 133, speed: 3000, bulletSpeed: 3, timeGone: 0, direction: {x: 1, y: 0}});
      tutorialCheck.checked = true;
    }
  }
  var canvas = textur.getContext('2d');
  textur.width = window.innerWidth - textur.getBoundingClientRect().left;
  textur.height = wHeight - textur.getBoundingClientRect().top - 10;
  canvas.fillStyle = "black";
  canvas.fillRect(0, 0, textur.width, textur.height);
  //   var cannons = [{x: 10, y: 10, width: 17, height: 17, speed: 1777, bulletSpeed: 10, timeGone: 0, direction: {x: 1, y: 0}}];
  var cannons = [];
  var bullets = [];
  function animateBullet(time) {
    canvas.fillStyle = "black";
    canvas.fillRect(0, 0, textur.width, textur.height);
    // show selected player bullet
    canvas.fillStyle = "red";
    var selectedBullet = player.bullets.got[player.selectedBullet];
    if (selectedBullet) {
    selectedBullet.y = player.position - selectedBullet.height;
    canvas.fillRect(selectedBullet.x, selectedBullet.y, selectedBullet.width, selectedBullet.height);
    }
    canvas.fillStyle = "white";
    for (var cannon of cannons) {
      canvas.fillRect(cannon.x, cannon.y, cannon.width, cannon.height);
      cannon.timeGone += 16;
      if (cannon.timeGone == 16 || cannon.timeGone >= cannon.speed) {
        cannon.timeGone = 1;
        bullets.push(JSON.parse(JSON.stringify({speed: cannon.bulletSpeed, x: cannon.x + 1*Math.abs(cannon.direction.y), y: cannon.y + 1*Math.abs(cannon.direction.x), width: cannon.width - 2*Math.abs(cannon.direction.y), height: cannon.height - 2*Math.abs(cannon.direction.x), direction: cannon.direction})));
      }
    }
    bullets.forEach((bullet, i) => {
      // bullet room collision
      if (bullet.x + bullet.width > window.innerWidth - 50) {
        lives.now -= bullet.width;
        bullets.splice(i, 1);
        new Audio('https://adi.nicolaiweitkemper.de/Sounds/protectTheRoom/damage.wav').play();
      }
      else {
      // player bullet collision check
      if (!bullet.fromPlayer && isCollide(bullet, {x: window.innerWidth - 110, y: player.position, width: 50, height: 50})) {
        console.log("player hit bullet!");
        if (player.bullets.got.length < player.bullets.max && phase.name != "useAmmo") {
          new Audio('https://adi.nicolaiweitkemper.de/Sounds/protectTheRoom/pick_bullet.wav').play();
          bullet.direction.x = -1;
          bullet.fromPlayer = true;
          if (phase.name != "collectAmmo" || window.innerWidth - 110 + (bullet.width/2)/* + 50*/ - bullet.width >= window.innerWidth - 50 - bullet.width) bullet.x = window.innerWidth - 110 + 50 - bullet.width;
          else bullet.x = window.innerWidth - 110 + (bullet.width/2)/* + 50*/ - bullet.width;
          player.bullets.got.push(JSON.parse(JSON.stringify(bullet)))
          if (tutorial.status == "waiting for bullet 2") tutorial.status = "shoot";
          if (tutorial.status == "collectAmmo") {
            tutorial.counter++;
            if (tutorial.counter > 1) {
              tutorial.status = "choose right ammo";
            }
          }
        }
        bullets.splice(i, 1);
      }
      // player bullet cannons collision check
      if (bullet.fromPlayer) {
        cannons.forEach((cannon, i1) => {
          if (isCollide(cannon, bullet)) {
            cannons.splice(i1, 1);
            new Audio('https://adi.nicolaiweitkemper.de/Sounds/protectTheRoom/cannon_explosion.wav').play();
            if (tutorial.status == "kill/shoot cannons") {
              tutorial.counter++;
              if (tutorial.counter > 2) {
                player.bullets.max = 1;
                space_key.style.display = "none";
                tutorialCheck.checked = false;
                tutorial.status = "no";
                localStorage.setItem('tutorialPlayed', true);
              }
            }
          }
        });
      }
      var playerBullets = bullets.filter(a => a.fromPlayer);
      if (selectedBullet) playerBullets.push(JSON.parse(JSON.stringify(selectedBullet)));
      // player bullet enemy bullet collision check
      playerBullets.forEach((playerBullet, i1) => {
        if (playerBullet && !bullet.fromPlayer && isCollide(playerBullet, bullet) && JSON.stringify(playerBullet) != JSON.stringify(bullet)) {
          bullets.splice(i, 1);
          new Audio('https://adi.nicolaiweitkemper.de/Sounds/protectTheRoom/shot_shot.wav').play();
          if (player.selectedBullet == player.bullets.got.length - 1 && player.selectedBullet > 0) player.selectedBullet--;
          if (i1 == playerBullets.length - 1 && selectedBullet) {
            console.log("defended with bullet on hand!");
            player.bullets.got.splice(player.selectedBullet, 1);
            if (tutorial.status == "collectAmmo") {
              restartTutorial();
            }
            if (tutorial.status == "waiting for bullet") tutorial.status = "waiting for bullet 2";
          }
        }
      });
    }
      canvas.fillStyle = "white";
      if (bullet.fromPlayer) canvas.fillStyle = "red";
      canvas.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
      bullet.x += bullet.speed*bullet.direction.x;
      bullet.y += bullet.speed*bullet.direction.y;
    });
    bullets = bullets.filter(b => b.x < textur.width && b.y < textur.height && b.y >= -(b.height) && b.x >= -(b.width));
    if (!bullets.length && ger채t == "Handy" && tutorial.status == "no" && newCannon.counter && newCannon.counter < 3) newCannon.time.needed = JSON.parse(JSON.stringify(newCannon.time.got));
    // room layout
    canvas.fillStyle = "white";
    canvas.fillRect(window.innerWidth - 50, 0, 35, wHeight);
    canvas.fillStyle = "rgba(40, 228, 70, 0.55)";
    canvas.fillRect(window.innerWidth - 50, -wHeight*(lives.now/lives.beginning) + wHeight, 35, wHeight);
    newCannon.time.got += 16;
    if (newCannon.time.got >= newCannon.time.needed && tutorial.status == "no") {
      if (ger채t == "Handy") var size = (Math.round(Math.random()*(140 - player.speed*2)) + (player.speed*2))/1.7;
      else var size = (Math.round(Math.random()*(140 - player.speed)) + player.speed)/1.7;
      // size = size*((window.innerWidth*wHeight)/(1600*1069));
      cannons.push({x: 33, y: Math.round(Math.random()*(textur.getBoundingClientRect().height - 3 - (size*(((window.innerWidth*wHeight)/(1600*1069)))*1.7))), width: size*(((window.innerWidth*wHeight)/(1600*1069)))*1.7, height: size*(((window.innerWidth*wHeight)/(1600*1069)))*1.7, speed: /*Math.round(Math.random()**/speed.cannon/*)*/, bulletSpeed: speed.bullet, timeGone: 0, direction: {x: 1, y: 0}});
      // if (cannons[cannons.length - 1].speed < speed.minTime) cannons[cannons.length - 1].speed = 999;
      // do {
      // var cannonCollsion = false;
      // for (var cannon of cannons) {
      //   if (cannons[cannons.length - 1] && isCollide(cannon, cannons[cannons.length - 1]) && JSON.stringify(cannon) != JSON.stringify(cannons[cannons.length - 1])) {
      //     cannons[cannons.length - 1].y = Math.round(Math.random()*wHeight - size);
      //     cannonCollsion = true;
      //   }
      // }
      // } while (cannonCollsion);
      if (cannons[cannons.length - 1].y < size) cannons[cannons.length - 1].y = size;
      newCannon.counter++;
      if (phase.counter) phase.counter--;
      var original = wHeight;
      if (newCannon.time.needed > convertNumber *1.2 && phase.name == "normal") newCannon.time.needed -= 16;
      else if (!useMultAmmo.checked && newCannon.time.needed > convertNumber *1) newCannon.time.needed -= 16;
        else if (useMultAmmo.checked && phase.counter == 0) {
       if (phase.name == "normal" || phase.name == "useAmmo") {
         setTimeout(function () {
           phase.name = "collectAmmo";
           adaptToScreen();
           newCannon.time.needed = convertNumber *5 - convertNumber *1.5//3;
           if (ger채t == "Handy") newCannon.time.needed += 1333;
           setTimeout(function () {
             player.speed = /*adaptToHeight(*/33;
           }, 1777);
           speed.bullet = 5//3;
           phase.counter = player.bullets.max + 3;//9;
           console.log(phase.name);
         }, 1555);
        }
        else if (phase.name == "collectAmmo") {
          cannons = [];
          speed.bullet = 11;
          newCannon.time.needed = convertNumber *1.4//3;
          phase.name = "useAmmo";
          adaptToScreen();
          player.speed = 45;
          if (ger채t == "Handy") player.speed = adaptToHeight(90);
          phase.counter = player.bullets.max - 2 //4;
          bullets.pop();
          console.log(phase.name);
          player.bullets.max++;
        }
      }
      else if (useMultAmmo.checked && !phase.counter) phase.counter = 7;
      if (player.speed < 89 && ger채t != "Handy") player.speed += 0.2;
      else if (player.speed < 89) player.speed += 0.3;
      else if (!useMultAmmo.checked && player.speed < adaptToHeight(99)) player.speed += 0.2;
      if (player.bullets.max < 6 && !(newCannon.counter/(10 + Math.round(newCannon.counter/10)) + "").includes('.')) player.bullets.max++;
      if (speed.bullet < 11 && ger채t != "Handy") speed.bullet += 0.1;
      else if (speed.bullet < 11) speed.bullet += 0.2;
      else if (!useMultAmmo.checked && speed.bullet < 13) speed.bullet += 0.1;
      newCannon.time.got = 0;
    }
    // layout ammo
    player.bullets.got.sort((x, y) => x.width - y.width);
    var lastAmmoPosition = 0;
    for (var i = 0; i < player.bullets.max; i++) {
      var bullet = player.bullets.got[i];
      if (player.bullets.got[i]) {
        canvas.fillStyle = "rgba(255, 0, 0, 0.5)";
        canvas.fillRect(10 + lastAmmoPosition, 10 + 27, bullet.width, bullet.height);
        if (i == player.selectedBullet) canvas.fillRect(10 + lastAmmoPosition, 10 + 27 + bullet.height + 10, bullet.width, 10);
        lastAmmoPosition += bullet.width + 10;
      }
      else {
        canvas.fillStyle = "rgba(131, 123, 123, 0.5)";
        canvas.fillRect(10 + lastAmmoPosition, 10 + 27, 50, 50);
        lastAmmoPosition += 60;
      }
    }
    canvas.font = "35px Arial";
    canvas.fillStyle = "rgba(131, 123, 123, 0.5)";
    canvas.fillText("score: " + newCannon.counter, 10, 8 + 20);
    if (player.selectedBullet == -1) {
    	player.reload.left -= 16;
    	if (player.reload.left < 1) {
      	player.selectedBullet = player.reload.index;
      }
    }
    if (lives.now > 0 && !(tutorial.status == "no" && tutorialCheck.checked)) requestAnimationFrame(animateBullet);
    else {
      if (lives.now <= 0 && tutorial.status != "no") restartTutorial();
      settings.style.display = "inline";
      enableScroll();
    	if (!highscores[name] || newCannon.counter > highscores[name]) highscores[name] = newCannon.counter;
    }
    // player layout
canvas.fillStyle = "white";
canvas.fillRect(window.innerWidth - 110, player.position, 50, 50);
var arrows = {left: new Image(), right: new Image(), up: new Image(), down: new Image()};
for (var direc of Object.keys(arrows)) {
  arrows[direc].src = 'https://adi.nicolaiweitkemper.de/Bilder/keys/' + swipeStr + direc + '_arrow.png';
}
if (tutorial.status.includes("move") && ger채t == "PC") {
  canvas.drawImage(arrows.up, window.innerWidth - 110, player.position - 50, 50, 50);
  canvas.drawImage(arrows.down, window.innerWidth - 110 + 5, player.position + 50, 40, 40);
}
else if (tutorial.status.includes("move")) {
  canvas.drawImage(arrows.up, window.innerWidth - 110 - 65, player.position - 50 - 77, 110, 110);
  canvas.drawImage(arrows.down, window.innerWidth - 110 + 5 - 100, player.position + 50 - 7, 150, 150);
}
if (tutorial.status == "shoot") {
  space_key.style.display = "inline";
}
  if (tutorial.status == "choose right ammo") {
    space_key.style.display = "none";
    canvas.fillStyle = "rgba(255, 255, 255, 0.6)";
    canvas.fillRect(0, 200, window.innerWidth, window.innerHeight);
    canvas.fillRect(255, 0, window.innerWidth - 255, 200);
    var img = new Image();
    img.src = 'http://adi.nicolaiweitkemper.de/Bilder/keys/' + swipeStr + 'left_arrow.png';
    canvas.drawImage(img, 45, 195, 40, 40);
    var img = new Image();
    img.src = 'http://adi.nicolaiweitkemper.de/Bilder/keys/' + swipeStr + 'right_arrow.png';
    canvas.drawImage(img, 165, 195, 50, 50);
  }
  }
  function restartTutorial() {
    tutorial.status = "no";
    setTimeout(function () {
      startGame(true);
    }, 100);
  }
var convertNumber;
adaptToScreen();
function adaptToScreen() {
  convertNumber = ((wHeight*window.innerWidth));
  var handyPlus = 0;
  if (ger채t == "Handy" && phase.name != "collectAmmo") handyPlus = 9.5;
  else if (ger채t == "Handy") handyPlus = -0.5;
  if (convertNumber/1069/1600 < 1) convertNumber *= (convertNumber/1069/1600)*(1.29 + handyPlus) + 1;
  else if (convertNumber/1069/1600 > 1) convertNumber *= (convertNumber/1069/1600)*1.7;
  convertNumber /= window.innerWidth;
}
function adaptToHeight(original) {
  // original*(wHeight/1069)*1.4;
  for (var i = 1.3; ger채t == "Handy" && i >= 1; i -= 0.1) {
    if (original*(wHeight/1069)*i < original && wHeight < 1069) original *= (wHeight/1069)*i;
  }
  return original;
}
if (!localStorage.getItem('tutorialPlayed')) startGame(true);
function isCollide(a, b) {
  return (a.x < b.x + b.width &&
   a.x + a.width > b.x &&
   a.y < b.y + b.height &&
   a.y + a.height > b.y)
}

// enableand disable scrolling
// left: 37, up: 38, right: 39, down: 40,
// spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
var keys = {37: 1, 38: 1, 39: 1, 40: 1};

function preventDefault(e) {
  e.preventDefault();
}

function preventDefaultForScrollKeys(e) {
  if (keys[e.keyCode]) {
    preventDefault(e);
    return false;
  }
}

// modern Chrome requires { passive: false } when adding event
var supportsPassive = false;
try {
  window.addEventListener("test", null, Object.defineProperty({}, 'passive', {
    get: function () { supportsPassive = true; }
  }));
} catch(e) {}

var wheelOpt = supportsPassive ? { passive: false } : false;
var wheelEvent = 'onwheel' in document.createElement('div') ? 'wheel' : 'mousewheel';

// call this to Disable
function disableScroll() {
  window.addEventListener('DOMMouseScroll', preventDefault, false); // older FF
  window.addEventListener(wheelEvent, preventDefault, wheelOpt); // modern desktop
  window.addEventListener('touchmove', preventDefault, wheelOpt); // mobile
  window.addEventListener('keydown', preventDefaultForScrollKeys, false);
}

// call this to Enable
function enableScroll() {
  window.removeEventListener('DOMMouseScroll', preventDefault, false);
  window.removeEventListener(wheelEvent, preventDefault, wheelOpt);
  window.removeEventListener('touchmove', preventDefault, wheelOpt);
  window.removeEventListener('keydown', preventDefaultForScrollKeys, false);
}
document.addEventListener('touchmove', touch);
document.addEventListener('touchstart', touch);
document.addEventListener('touchend', touch);
// document.getElementById('textur').style = "touch-action: none";
var swipe = {};
document.onkeydown = function(event) {
  if (event.key.toLowerCase().includes("up")) {
    player.position -= player.speed;
  }
  if (event.key.toLowerCase().includes("down")) {
    player.position += player.speed;
    if (cannons[0] && player.position >= cannons[0].y + player.speed && tutorial.status == "moveDown") tutorial.status = "waiting for bullet";
  }
  if (event.key.toLowerCase().includes("left") && player.selectedBullet > 0) player.selectedBullet--;
  if (event.key.toLowerCase().includes("right") && player.selectedBullet + 1 < player.bullets.got.length && player.selectedBullet != -1) {
    incAmmoIndex();
  }
  if (event.key == " ") {
      player.shoot(player.bullets.got[player.selectedBullet]);
    return false;
  }
}

function touch(ev) {
  if (ev.touches[1]) player.shoot();
  if (ev.type == "touchstart") {
    var firstTouch = getTouches(ev)[0];
    xDown = firstTouch.clientX;
    yDown = firstTouch.clientY;
    swipe = {beginning: {x: firstTouch.clientX, y: firstTouch.clientY}, counter: -5};
  }
  if (ev.type == "touchmove") {
    swipe.counter++;
    var xDiff = swipe.beginning.x - ev.touches[0].clientX;
    var yDiff = yDown - ev.touches[0].clientY;
    firstTouch = getTouches(ev)[0];
    if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
      if (swipe.counter == 10 || swipe.counter == -1) {
        swipe.counter = 0;
        if ( xDiff > 0 && player.selectedBullet > 0) {
          player.selectedBullet--;
            /* left swipe */
        } else if (xDiff < 0 && player.selectedBullet + 1 < player.bullets.got.length && player.selectedBullet != -1) {
            /* right swipe */
            incAmmoIndex();
        }
      }
    } else {
        if ( yDiff > 0 ) {
            /* up swipe */
            player.position -= player.speed/3;
        } else {
            /* down swipe */
            if (cannons[0] && player.position >= cannons[0].y + player.speed && tutorial.status == "moveDown") tutorial.status = "waiting for bullet";
            player.position += player.speed/3;
        }
    }
  }
  // toggleFullscreen(document.body);
}
var xDown;
var yDown;
function incAmmoIndex() {
  player.selectedBullet++;
  if (tutorial.status == "choose right ammo") {
    tutorial.status = "kill/shoot cannons";
    tutorial.counter = 0;
    cannons.push({x: 33, y: 10, width: 33, height: 33, speed: 3000, bulletSpeed: 3, timeGone: 0, direction: {x: 1, y: 0}});
    cannons.push({x: 33, y: 100, width: 33, height: 33, speed: 3000, bulletSpeed: 3, timeGone: 0, direction: {x: 1, y: 0}});
    cannons.push({x: 33, y: 200, width: 33, height: 33, speed: 3000, bulletSpeed: 3, timeGone: 0, direction: {x: 1, y: 0}});
    space_key.style.display = "inline";
    space_key.innerHTML = "kill them!";
  }
}
function getTouches(ev) {
return ev.touches ||             // browser API
       ev.originalEvent.touches; // jQuery
}

// audio:
var playerObj = {space: null, fight: null};
function onYouTubePlayerAPIReady() {
  var playerOby = new YT.Player('spacePlayer', {
      videoId: 'tNkZsRW7h2c', // this is the id of the video at youtube (the stuff after "?v=")
      loop: true,
      events: {
          onReady: function (e) {
              playerObj.space = e.target;
              if (localStorage.getItem('spaceMusic') == "true" || localStorage.getItem('spaceMusic') == null) e.target.playVideo();
            },
      }
  });
  var playerOby = new YT.Player('fightPlayer', {
      videoId: 'abg4hqQs5b8', // this is the id of the video at youtube (the stuff after "?v=")
      loop: true,
      events: {
          onReady: function (e) {
              playerObj.fight = e.target;
            },
      }
  });
  // you can do more stuff with the player variable
}
document.addEventListener("click", player.shoot);
</script>
