<input type="text" value="60" id="distance" placeholder="distance">
<button type="button" onclick="drawRandomMap(true);" name="button">create</button>
<input id="manualControwl" type="checkbox"> controwl with arrows
<canvas id="textur" width="1582" height="740"></canvas>
<script>
    textur.width = window.innerWidth;
    textur.height = window.innerHeight;
    var canvas = textur.getContext('2d'); //Dimension
    function drawRandomMap(straight) {
      canvas.fillStyle = "green";
      canvas.fillRect(0, 0, window.innerWidth, window.innerHeight);
      canvas.fillStyle = "black";
      currentProcess = {counter: Math.round(window.innerWidth/3), string: "straight"};
      moveDrawingPointer({bottom: 10, top: 10}, {bottom: 33 + JSON.parse(distance.value), top: 33}, {x: 1, y: 0}, straight);
    }
    function moveDrawingPointer(x, y, currentDirection, straight, randomDirectionBefore) {
      var possibleDirections = ["straight", "right", "left"]
      do {
        if (randomDirection) randomDirectionBefore = randomDirection;
        if (straight) var randomDirection = Math.round(Math.random()*2);
        else var randomDirection = Math.round(Math.random()*4);
      } while (randomDirection == randomDirectionBefore && !manualControwl.checked);
      document.onkeydown = function(event) {
      if (manualControwl.checked && (event.key.replace("Arrow", "").toLowerCase() == "left" || event.key.replace("Arrow", "").toLowerCase() == "right")) currentProcess = {string: event.key.replace("Arrow", "").toLowerCase(), counter: 1};
      }
      console.log(currentProcess);
      console.log(currentDirection);
      if (currentProcess.string == "straight" || (currentProcess.string == "random" && possibleDirections[randomDirection] == "straight")) {
        if (!currentDirection.bottom) x.bottom += currentDirection.x;
        if (!currentDirection.bottom) y.bottom += currentDirection.y;
        if (!currentDirection.top) x.top += currentDirection.x;
        if (!currentDirection.top) y.top += currentDirection.y;
        if (currentProcess.counter == 0) {
            if (!manualControwl.checked) currentProcess.counter = 11 + Math.round(Math.random()*((window.innerHeight - x.top)));
            if (y.bottom + currentProcess.counter > window.innerHeight - JSON.parse(distance.value)) {
              console.log("debug");
              if (!manualControwl.checked) currentProcess.counter = window.innerHeight - JSON.parse(distance.value) - y.bottom;
            }
            currentProcess.string = "straight";
      }
    }
      if (currentProcess.string == "right" || (currentProcess.string == "random" && possibleDirections[randomDirection] == "right")) {
        var newDirectionObj = {"1|0": "0|1", "0|1": "-1|0", "-1|0": "0|-1", "0|-1": "1|0"};
        var getAheadIfObj = {};
        getAheadIfObj["1|0"] = x.bottom != x.top - JSON.parse(distance.value);
        getAheadIfObj["0|1"] = y.bottom + JSON.parse(distance.value) != y.top;
        getAheadIfObj["-1|0"] = x.bottom != x.top + JSON.parse(distance.value);
        getAheadIfObj["0|-1"] = y.bottom - JSON.parse(distance.value) != y.top;
        if (getAheadIfObj[currentDirection.x + '|' + currentDirection.y]) {
          x.top += currentDirection.x;
          y.top += currentDirection.y;
        }
        else {
          currentDirection = {x: JSON.parse(newDirectionObj[currentDirection.x + '|' + currentDirection.y].split('|')[0]), y: JSON.parse(newDirectionObj[currentDirection.x + '|' + currentDirection.y].split('|')[1]), bottom: true};
          currentProcess.string = "straight";
          currentProcess.counter = JSON.parse(distance.value);
        }
        // if (y.bottom != y.top - JSON.parse(distance.value)) y.top += currentDirection.y;
        // else {
        //   currentDirection = {x: 0, y: 1};
        //   currentProcess.string = "random";
        // }
        if (currentProcess.counter == 0 && !manualControwl.checked) {
          currentProcess = {string: "right", counter: JSON.parse(distance.value) + Math.round(Math.random()*(window.innerHeight - x.top))};
          if (y.bottom + currentProcess.counter > window.innerHeight - JSON.parse(distance.value)) {
            if (!manualControwl.checked) currentProcess.counter = window.innerHeight - JSON.parse(distance.value) - y.bottom;
            console.log("debug");
          }
      }
      }
      if (currentProcess.string == "left" || (currentProcess.string == "random" && possibleDirections[randomDirection] == "left")) {
        var newDirectionObj = {"1|0": "0|-1", "0|-1": "-1|0", "-1|0": "0|1", "0|1": "1|0"};
        var getAheadIfObj = {};
        getAheadIfObj["1|0"] = x.top + JSON.parse(distance.value) != x.bottom;
        getAheadIfObj["0|1"] = y.bottom != y.top + JSON.parse(distance.value);
        getAheadIfObj["-1|0"] = x.bottom + JSON.parse(distance.value) != x.top;
        getAheadIfObj["0|-1"] = y.bottom != y.top - JSON.parse(distance.value);
        if (getAheadIfObj[currentDirection.x + '|' + currentDirection.y]) {
          x.bottom += currentDirection.x;
          y.bottom += currentDirection.y;
        }
        else {
          currentDirection = {x: JSON.parse(newDirectionObj[currentDirection.x + '|' + currentDirection.y].split('|')[0]), y: JSON.parse(newDirectionObj[currentDirection.x + '|' + currentDirection.y].split('|')[1]), top: true};
          currentProcess.string = "straight";
          currentProcess.counter = JSON.parse(distance.value);
        }
        // if (y.bottom != y.top - JSON.parse(distance.value)) y.top += currentDirection.y;
        // else {
        //   currentDirection = {x: 0, y: 1};
        //   currentProcess.string = "random";
        // }
        if (currentProcess.counter == 0 && !manualControwl.checked) {
          currentProcess = {string: "left", counter: JSON.parse(distance.value) + Math.round(Math.random()*(window.innerHeight - x.top))};
          if (y.bottom + currentProcess.counter > window.innerHeight - JSON.parse(distance.value)) {
            if (!manualControwl.checked) currentProcess.counter = window.innerHeight - JSON.parse(distance.value) - y.bottom;
            console.log("debug");
          }
      }
      }
      // canvas.fillStyle = "black";
      canvas.fillRect(x.top, y.top, 1, 1);
      canvas.fillRect(x.bottom, y.bottom, 1, 1);
      // canvas.fillStyle = "#6E6E6E";
      // canvas.fillRect(x.top + currentDirection.y, y.top + currentDirection.x, 1, JSON.parse(distance.value) - 1);
      /*if (!manualControwl.checked) */currentProcess.counter--;
      if (currentProcess.counter == 0) {
        if (currentDirection.bottom || currentDirection.top) {
          if (!manualControwl.checked) currentProcess.counter = Math.round(Math.random()*(window.innerHeight - x.top));
          if (y.bottom + currentProcess.counter > window.innerHeight - JSON.parse(distance.value)) {
            if (!manualControwl.checked) currentProcess.counter = window.innerHeight - JSON.parse(distance.value) - y.bottom;
            console.log("debug");
          }
          currentDirection.bottom = undefined;
          currentDirection.top = undefined;
        }
        else if (!manualControwl.checked) currentProcess.string = "random";
      }
      // if (currentDirection.x > 0) canvas.fillRect(x, y + JSON.parse(distance.value), 1, 1);
      // else if (currentDirection.y > 0) canvas.fillRect(x + JSON.parse(distance.value), y, 1, 1);
      setTimeout(function () {
        if (x.top > 0 && y.top > 0 && x.top < window.innerWidth && y.top < window.innerHeight) moveDrawingPointer(x,y, currentDirection, straight, currentProcess, randomDirection);
      }, 1);
    }
    document.addEventListener('touchstart', handleTouchStart, false);
    document.addEventListener('touchmove', handleTouchMove, false);
  var xDown;
  var yDown;

  function getTouches(evt) {
  return evt.touches ||             // browser API
         evt.originalEvent.touches; // jQuery
  }
  function handleTouchStart(evt) {
    const firstTouch = getTouches(evt)[0];
    xDown = firstTouch.clientX;
    yDown = firstTouch.clientY;
  };
  var currentProcess = {};
  function handleTouchMove(evt) {
    /*if ( ! xDown || ! yDown ) {
        return;
    } */
    var xUp = evt.touches[0].clientX;
    var yUp = evt.touches[0].clientY;
    //document.getElementById('koordinaten2').innerHTML = xDiff + " - " + yDiff;
    var xDiff = xDown - xUp;
    var yDiff = yDown - yUp;

    if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
        if ( xDiff > 0 ) currentProcess = {string: "left", counter: 1};
        else {
            currentProcess = {string: "right", counter: 1};
        }
    } else {
        if ( yDiff > 0 ) currentProcess = {string: "up", counter: 1};
        else currentProcess = {string: "down", counter: 1};
    }
  };

  </script>
</script>
